# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../htdig/CVE-2007-6110.patch
# Copyright (C) 2007 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

diff -Nur htdig-3.2.0b6-orig/htsearch/Display.cc htdig-3.2.0b6/htsearch/Display.cc
--- htdig-3.2.0b6-orig/htsearch/Display.cc	2007-12-13 10:20:02.000000000 +0000
+++ htdig-3.2.0b6/htsearch/Display.cc	2007-12-13 10:20:29.000000000 +0000
@@ -137,7 +137,7 @@
       // Must temporarily stash the message in a String, since
       // displaySyntaxError will overwrite the static temp used in form.
 
-      String s(form("No such sort method: `%s'", (const char*)config->Find("sort")));
+      String s("invalid sort method");
 
       displaySyntaxError(s);
       return;
diff -Nur htdig-3.2.0b6-orig/libhtdig/ResultFetch.cc htdig-3.2.0b6/libhtdig/ResultFetch.cc
--- htdig-3.2.0b6-orig/libhtdig/ResultFetch.cc	2007-12-13 10:20:02.000000000 +0000
+++ htdig-3.2.0b6/libhtdig/ResultFetch.cc	2007-12-13 10:20:29.000000000 +0000
@@ -142,7 +142,7 @@
         // Must temporarily stash the message in a String, since
         // displaySyntaxError will overwrite the static temp used in form.
 
-        String s(form("No such sort method: `%s'", (const char *) config->Find("sort")));
+        String s("invalid sort method");
 
         displaySyntaxError(s);
         //return;

[COPY] --- T2-COPYRIGHT-BEGIN ---
[COPY] t2/package/*/localsend/localsend.desc
[COPY] Copyright (C) 2026 The T2 SDE Project
[COPY] SPDX-License-Identifier: GPL-2.0
[COPY] --- T2-COPYRIGHT-END ---

[I] An open-source cross-platform alternative to AirDrop

[T] LocalSend is a free, open-source app that allows you to securely
[T] share files and messages with nearby devices over your local network
[T] without needing an internet connection. Unlike other apps, LocalSend
[T] does not require an external server or internet access. It uses a
[T] secure REST API over HTTPS for local device communication. Built
[T] with Flutter, it runs natively on Linux, macOS, Windows, Android and iOS.

[U] https://localsend.org/
[U] https://github.com/localsend/localsend

[A] Tien Do Nam <tiendn@localsend.org>
[M] The T2 Project <t2@t2-project.org>

[C] extra/network
[F] BINARY
[R] + x86-64 arm64

[L] APL
[S] Stable
[V] 1.17.0
[P] X -----5---9 200.000

[D] 7d3cb1dfc2068b59e279d29dd94da983b11ee6ea712809a31dd93cd3 LocalSend-1.17.0-linux-x86-64.tar.gz https://github.com/localsend/localsend/releases/download/v1.17.0/
[D] 57c1fa5baa84ab6dfe2bdefe3701065787b6bf7ad7506c3b6d5623f8 LocalSend-1.17.0-linux-arm-64.tar.gz https://github.com/localsend/localsend/releases/download/v1.17.0/

autoextract=0
runmake=0
prefix=opt/localsend
set_confopt

localsend_postmake() {
	local tarball

	case $arch in
	x86-64) tarball=$(match_source_file -p x86-64) ;;
	arm64)  tarball=$(match_source_file -p arm-64) ;;
	*)
		echo "Unsupported architecture: $arch"
		return 1
		;;
	esac

	install -d $root/$prefix
	tar -C $root/$prefix $taropt $tarball

	chmod 755 $root/$prefix/localsend_app

	install -d $root/usr/share/applications
	cat > $root/usr/share/applications/localsend.desktop << 'EOF'
[Desktop Entry]
Name=LocalSend
Comment=Share files to nearby devices
Exec=/opt/localsend/localsend_app %u
Icon=localsend
Type=Application
Categories=Network;FileTransfer;
MimeType=x-scheme-handler/localsend;
EOF

	ln -sf /$prefix/localsend_app $root/usr/bin/localsend
}

hook_add postmake 5 localsend_postmake

# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/mnemoc/ktcpvs/make_install.patch
# ROCK Linux is Copyright (C) 1998 - 2003 Clifford Wolf
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

--- ./Makefile.orig	Sat Apr 26 11:28:28 2003
+++ ./Makefile	Sat Apr 26 11:32:36 2003
@@ -22,7 +22,8 @@
 # relocations required by build roots.  This is not defined in the
 # makefile but the arguement can be passed to make if needed.
 
-MODLIB		= $(INSTALL_MOD_PATH)/lib/modules/$(KERNELRELEASE)/kernel/net/ktcpvs/
+MODDIR		= kernel/net/ktcpvs/
+MODLIB		= $(INSTALL_MOD_PATH)/lib/modules/$(KERNELRELEASE)/$(MODDIR)
 
 # If System.map exists, run depmod.  This deliberately does not have a
 # dependency on System.map since that would run the dependency tree on
@@ -36,6 +37,7 @@
 endif
 
 CC		= gcc
+DEPMOD		= /sbin/depmod
 CFLAGS		= -D__KERNEL__ -DMODULE  -DEXPORT_SYMTAB -DMODVERSIONS	\
 		$(SMPFLAGS) $(DEBUGFLAGS) -O2 -Wall			\
 		-Wstrict-prototypes -I$(KERNELSOURCE)/include		\
@@ -79,7 +81,7 @@
 modules_install: $(TARGETS)
 		if [ ! -d "$(MODLIB)" ]; then mkdir -p "$(MODLIB)"; fi
 		install -m 600 -c $(TARGETS) "$(MODLIB)"
-		depmod -ae -F $(KERNELSYMS) $(depmod_opts) $(KERNELRELEASE)
+		$(DEPMOD) -ae -F $(KERNELSYMS) $(depmod_opts) $(KERNELRELEASE)
 
 modules_uninstall:
 		(cd "$(MODLIB)"; rm -f $(TARGETS))

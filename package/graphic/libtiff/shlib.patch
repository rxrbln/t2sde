# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/*/libtiff/shlib.patch
# Copyright (C) 1998 - 2003 ROCK Linux Project
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

--- ./libtiff/Makefile.in.orig	Tue Jul 18 03:24:57 2000
+++ ./libtiff/Makefile.in	Tue Jul 18 03:28:40 2000
@@ -64,6 +64,8 @@
 COPTS	= @GCOPTS@
 OPTIMIZER=-O
 CFLAGS	= @ENVOPTS@ @LIBCOPTS@ ${COPTS} ${OPTIMIZER} ${IPATH} ${CONF_LIBRARY}
+SONAME = libtiff.so.3
+SHLIB = libtiff.so.3.5.7
 #
 SRCS	= \
 	tif_aux.c \
@@ -135,7 +137,8 @@
 	tif_write.o \
 	tif_zip.o \
 	${NULL}
-TARGETS	= libtiff.a
+TARGETS	= libtiff.a $(SHLIB)
+SHOBJS= $(OBJS:%.o=%.so)
 
 all:	${TARGETS}
 	if [ @DSO@dso != nodso ]; then \
@@ -148,6 +151,9 @@
 	${AR} ${AROPTS} libtiff.a $?
 	${RANLIB} libtiff.a
 
+$(SHLIB): $(SHOBJS)
+	gcc -o $(SHLIB) -Wl,-soname,$(SONAME) -shared $(SHOBJS) -ljpeg -lz
+
 #
 # NB: The configure script verifies that the configured
 # tools are capable of producing a DSO before enabling
@@ -346,3 +352,5 @@
 	    mkg3states tif_fax3sm.c \
 	    mkversion version.h \
 	    libtiff.a libtiff.@DSOSUF@ libtiff.@DSOSUF_VERSION@ *dso
+%.so : %.c
+	$(CC) -c -fPIC $(CFLAGS) $(CPPFLAGS) $< -o $@
--- ./tools/Makefile.in.orig	Tue Jul 18 03:29:05 2000
+++ ./tools/Makefile.in	Tue Jul 18 03:30:06 2000
@@ -48,9 +48,10 @@
 CFLAGS	= @ENVOPTS@ ${COPTS} ${OPTIMIZER} ${IPATH}
 #
 TIFFLIB	= ${DEPTH}/libtiff/libtiff.@DSOSUF@
+TIFFLIB	= ${DEPTH}/libtiff/libtiff.so.3.5.7
 LIBJPEG	= @LIBJPEG@
 LIBGZ	= @LIBGZ@
-LIBTIFF	= @TIFFLIBREF@
+LIBTIFF        = -L${DEPTH}/libtiff  -ltiff
 LIBPORT	= @LIBPORT@
 MACHLIBS= @MACHDEPLIBS@
 LIBS	= ${LIBTIFF} ${LIBJPEG} ${LIBGZ} ${LIBPORT} ${MACHLIBS}

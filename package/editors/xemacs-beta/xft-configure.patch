
The pre-generated configure. Recent autoconf fail to generate it - so I used
and ancient system to do so and already hand merged it a few times.

Clean up majorly since each line-number reference changed and we do not want
a multiple hundret kB diff ...

  - Rene Rebe <rene@exactcode.de>

--- ./configure.orig	2004-10-22 07:16:35.000000000 +0200
+++ ./configure	2005-01-06 11:01:36.616775808 +0100
@@ -365,6 +365,7 @@
 	with_hesiod	| \
 	with_dnet	| \
 	with_infodock	| \
+	with_xft	| \
 	with_netinstall | \
 	with_ipv6_cname | \
 	external_widget | \
@@ -7474,8 +7475,138 @@
       esac
     fi
   fi
+  
+  if test "$with_xft" = "yes"; then
+    echo "checking xft-config program" 1>&6
+echo "configure:7396: checking xft-config program" >&5
+    # Extract the first word of "xft-config", so it can be a program name with args.
+set dummy xft-config; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:7400: checking for $ac_word" >&5
+
+if test -n "$XFT_CONFIG"; then
+  ac_cv_prog_XFT_CONFIG="$XFT_CONFIG" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_XFT_CONFIG=""yes""
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+  test -z "$ac_cv_prog_XFT_CONFIG" && ac_cv_prog_XFT_CONFIG=""no""
+fi
+XFT_CONFIG="$ac_cv_prog_XFT_CONFIG"
+if test -n "$XFT_CONFIG"; then
+  echo "$ac_t""$XFT_CONFIG" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+
+    if test "$XFT_CONFIG" = "yes"; then
+      echo "$ac_t""found" 1>&6
+      libs_x="`xft-config --libs` $libs_x" &&  if test "$extra_verbose" = "yes"; then echo "    Prepending \"`xft-config --libs`\" to \$libs_x"; fi
+      X_CFLAGS="`xft-config --cflags` $X_CFLAGS" &&  if test "$extra_verbose" = "yes"; then echo "    Prepending \"`xft-config --cflags`\" to \$X_CFLAGS"; fi
+    else
+      echo "$ac_t""not found, checking for Xft 1.x" 1>&6
+      
+echo $ac_n "checking for XRenderQueryExtension in -lXrender""... $ac_c" 1>&6
+echo "configure:7433: checking for XRenderQueryExtension in -lXrender" >&5
+ac_lib_var=`echo Xrender'_'XRenderQueryExtension | sed 'y%./+-%__p_%'`
+
+xe_check_libs=" -lXrender "
+cat > conftest.$ac_ext <<EOF
+#line 7438 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char XRenderQueryExtension();
+
+int main() {
+XRenderQueryExtension()
+; return 0; }
+EOF
+if { (eval echo configure:7449: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+xe_check_libs=""
+
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes" ; then
+  echo "$ac_t""yes" 1>&6
+  libs_x="-lXrender $libs_x" &&  if test "$extra_verbose" = "yes"; then echo "    Prepending \"-lXrender\" to \$libs_x"; fi
+else
+  echo "$ac_t""no" 1>&6
+(echo "$progname: Usage error:"
+echo " " "Unable to find libXrender for --with-xft"
+echo "  Use \`$progname --help' to show usage.") >&2 && exit 1
+fi
+
+
+      
+echo $ac_n "checking for XftFontOpen in -lXft""... $ac_c" 1>&6
+echo "configure:7474: checking for XftFontOpen in -lXft" >&5
+ac_lib_var=`echo Xft'_'XftFontOpen | sed 'y%./+-%__p_%'`
 
+xe_check_libs=" -lXft "
+cat > conftest.$ac_ext <<EOF
+#line 7479 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char XftFontOpen();
+
+int main() {
+XftFontOpen()
+; return 0; }
+EOF
+if { (eval echo configure:7490: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+xe_check_libs=""
+
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes" ; then
+  echo "$ac_t""yes" 1>&6
+  libs_x="-lXft $libs_x" &&  if test "$extra_verbose" = "yes"; then echo "    Prepending \"-lXft\" to \$libs_x"; fi
+else
+  echo "$ac_t""no" 1>&6
+(echo "$progname: Usage error:"
+echo " " "Unable to find libXft for --with-xft"
+echo "  Use \`$progname --help' to show usage.") >&2 && exit 1
+fi
+
+
+    fi
+    { test "$extra_verbose" = "yes" && cat << \EOF
+    Defining USE_XFT
+EOF
+cat >> confdefs.h <<\EOF
+#define USE_XFT 1
+EOF
+}
+
+  fi
 fi 
+
 if test "$with_msw" != "no"; then
   echo "checking for MS-Windows" 1>&6
 echo "configure:7482: checking for MS-Windows" >&5
@@ -16774,6 +16905,9 @@
   if test "$with_xauth" != yes; then
     echo "    - Xau (X authority) not available."
   fi
+  if test "$with_xft" = "yes"; then 
+    echo "  Compiling in support for Xft antialiased fonts."
+  fi
   if test "$with_xmu" != yes; then
     echo "    - Xmu library not available; substituting equivalent routines."
   fi
@@ -17063,6 +17197,7 @@
 s%@X_PRE_LIBS@%$X_PRE_LIBS%g
 s%@X_LIBS@%$X_LIBS%g
 s%@X_EXTRA_LIBS@%$X_EXTRA_LIBS%g
+s%@XFT_CONFIG@%$XFT_CONFIG%g
 s%@install_pp@%$install_pp%g
 s%@libs_xauth@%$libs_xauth%g
 s%@dnd_objs@%$dnd_objs%g

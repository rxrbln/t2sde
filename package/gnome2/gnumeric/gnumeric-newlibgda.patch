--- gnumeric-1.5.3/plugins/gda/plugin-gda.c.orig	2005-08-09 16:37:46.000000000 -0700
+++ gnumeric-1.5.3/plugins/gda/plugin-gda.c	2005-08-25 21:25:47.000000000 -0700
@@ -119,12 +119,9 @@
 	real_user = g_strdup (user);
 	real_password = g_strdup (password);
 #endif
+	
 
-	cnc = gda_client_open_connection (connection_pool, real_dsn, real_user, real_password, options, &error);
-	if (!cnc) {
-		g_warning ("Libgda error: %s\n", error->message);
-		g_error_free (error);
-	}
+	cnc = gda_client_open_connection (connection_pool, real_dsn, real_user, real_password, options);
 
 	g_free (real_dsn);
 	g_free (real_user);
@@ -168,7 +165,6 @@
 	GdaDataModel*  recset;
 	GList*         recset_list;
 	GdaCommand*    cmd;
-	GError*        error = NULL;
 
 	dsn_name = value_get_as_string (args[0]);
 	user_name = value_get_as_string (args[1]);
@@ -184,7 +180,7 @@
 
 	/* execute command */
 	cmd = gda_command_new (sql, GDA_COMMAND_TYPE_SQL, 0);
-	recset_list = gda_connection_execute_command (cnc, cmd, NULL, &error);
+	recset_list = gda_connection_execute_command (cnc, cmd, NULL);
 	gda_command_free (cmd);
 	if (recset_list) {
 		recset = (GdaDataModel *) recset_list->data;
@@ -195,13 +191,8 @@
 
 		g_list_foreach (recset_list, (GFunc) g_object_unref, NULL);
 		g_list_free (recset_list);
-	} else {
-		if (error) {
-			ret = value_new_error (ei->pos, error->message);
-			g_error_free (error);
-		} else
-			ret = value_new_empty ();
-	}
+	} else
+		ret = value_new_empty ();
 
 	return ret;
 }
@@ -244,7 +235,6 @@
 	GdaDataModel*  recset;
 	GList*         recset_list;
 	GdaCommand*    cmd;
-	GError*        error = NULL;
 
 	dsn_name = value_get_as_string (args[0]);
 	user_name = value_get_as_string (args[1]);
@@ -260,7 +250,7 @@
 
 	/* execute command */
 	cmd = gda_command_new (table, GDA_COMMAND_TYPE_TABLE, 0);
-	recset_list = gda_connection_execute_command (cnc, cmd, NULL, &error);
+	recset_list = gda_connection_execute_command (cnc, cmd, NULL);
 	gda_command_free (cmd);
 	if (recset_list) {
 		recset = (GdaDataModel *) recset_list->data;
@@ -271,13 +261,8 @@
 
 		g_list_foreach (recset_list, (GFunc) g_object_unref, NULL);
 		g_list_free (recset_list);
-	} else {
-		if (error) {
-			ret = value_new_error (ei->pos, error->message);
-			g_error_free (error);
-		} else
-			ret = value_new_empty ();
-	}
+	} else
+		ret = value_new_empty ();
 
 	return ret;
 }

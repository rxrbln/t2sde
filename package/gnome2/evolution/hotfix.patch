# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/gnome24/evolution/hotfix.patch
# ROCK Linux is Copyright (C) 1998 - 2004 Clifford Wolf
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

diff -urN -x '*~' evolution-1.4.0-old/camel/providers/nntp/camel-nntp-store.c evolution-1.4.0-new/camel/providers/nntp/camel-nntp-store.c
--- evolution-1.4.0-old/camel/providers/nntp/camel-nntp-store.c	2002-05-28 05:00:31.000000000 +0200
+++ evolution-1.4.0-new/camel/providers/nntp/camel-nntp-store.c	2003-07-04 16:51:28.000000000 +0200
@@ -114,7 +114,7 @@
 #ifdef HAVE_SSL
 	if (ssl_mode != USE_SSL_NEVER) {
 		port = service->url->port ? service->url->port : NNTPS_PORT;
-		tcp_stream = camel_tcp_stream_ssl_new (service, service->url->host);
+		tcp_stream = camel_tcp_stream_ssl_new (service, service->url->host, 0);
 	} else {
 		tcp_stream = camel_tcp_stream_raw_new ();
 	}
diff -urN -x '*~' evolution-1.4.0-old/camel/providers/nntp/camel-nntp-summary.h evolution-1.4.0-new/camel/providers/nntp/camel-nntp-summary.h
--- evolution-1.4.0-old/camel/providers/nntp/camel-nntp-summary.h	2002-05-07 09:31:25.000000000 +0200
+++ evolution-1.4.0-new/camel/providers/nntp/camel-nntp-summary.h	2003-07-04 15:13:18.000000000 +0200
@@ -24,7 +24,6 @@
 #include <camel/camel-folder-summary.h>
 #include <camel/camel-folder.h>
 #include <camel/camel-exception.h>
-#include <libibex/ibex.h>
 
 #define CAMEL_NNTP_SUMMARY(obj)         CAMEL_CHECK_CAST (obj, camel_nntp_summary_get_type (), CamelNNTPSummary)
 #define CAMEL_NNTP_SUMMARY_CLASS(klass) CAMEL_CHECK_CLASS_CAST (klass, camel_nntp_summary_get_type (), CamelNNTPSummaryClass)
--- evolution-1.4.6/e-util/e-component-listener.c~	2003-06-04 17:05:09.000000000 +0200
+++ evolution-1.4.6/e-util/e-component-listener.c	2004-07-19 17:05:37.530238768 +0200
@@ -52,7 +52,6 @@
 			cl->priv->component = CORBA_OBJECT_NIL;
 			g_object_unref (cl);
 			break;
-		default :
 		}
 	}
 }
--- evolution-1.4.6/addressbook/conduit/address-conduit.c.orig	2004-07-19 21:45:44.116249336 +0200
+++ evolution-1.4.6/addressbook/conduit/address-conduit.c	2004-07-19 21:46:07.206739048 +0200
@@ -609,7 +609,6 @@
 		return E_CARD_SIMPLE_FIELD_EMAIL_2;
 	case E_CARD_SIMPLE_FIELD_EMAIL_2:
 		return E_CARD_SIMPLE_FIELD_EMAIL_3;
-	default:
 	}
 
 	return E_CARD_SIMPLE_FIELD_LAST;
@@ -624,7 +623,6 @@
 	switch (*field) {
 	case E_CARD_SIMPLE_FIELD_PHONE_HOME:
 		return E_CARD_SIMPLE_FIELD_PHONE_HOME_2;
-	default:
 	}
 
 	return E_CARD_SIMPLE_FIELD_LAST;
@@ -639,7 +637,6 @@
 	switch (*field) {
 	case E_CARD_SIMPLE_FIELD_PHONE_BUSINESS:
 		return E_CARD_SIMPLE_FIELD_PHONE_BUSINESS_2;
-	default:
 	}
 
 	return E_CARD_SIMPLE_FIELD_LAST;
@@ -656,7 +653,6 @@
 		return E_CARD_SIMPLE_FIELD_PHONE_HOME_FAX;
 	case E_CARD_SIMPLE_FIELD_PHONE_HOME_FAX:
 		return E_CARD_SIMPLE_FIELD_PHONE_OTHER_FAX;
-	default:
 	}
 
 	return E_CARD_SIMPLE_FIELD_LAST;
--- evolution-1.4.6/calendar/cal-client/cal-client.c.orig	2004-07-19 22:27:58.601948944 +0200
+++ evolution-1.4.6/calendar/cal-client/cal-client.c	2004-07-19 22:27:10.202306808 +0200
@@ -2886,26 +2886,26 @@
 	return cal_client_remove_object_with_mod (client, uid, CALOBJ_MOD_ALL);
 }
 
-CalClientResult
+CalClientSendResult
 cal_client_send_object (CalClient *client, icalcomponent *icalcomp, 
 			icalcomponent **new_icalcomp, GList **users,
 			char error_msg[256])
 {
 	CalClientPrivate *priv;
 	CORBA_Environment ev;
-	CalClientResult retval;
+	CalClientSendResult retval;
 	GNOME_Evolution_Calendar_UserList *user_list;
 	char *obj_string;
 	int i;
 	
-	g_return_val_if_fail (client != NULL, CAL_CLIENT_RESULT_INVALID_OBJECT);
-	g_return_val_if_fail (IS_CAL_CLIENT (client), CAL_CLIENT_RESULT_INVALID_OBJECT);
+	g_return_val_if_fail (client != NULL, CAL_CLIENT_SEND_INVALID_OBJECT);
+	g_return_val_if_fail (IS_CAL_CLIENT (client), CAL_CLIENT_SEND_INVALID_OBJECT);
 
 	priv = client->priv;
 	g_return_val_if_fail (priv->load_state == CAL_CLIENT_LOAD_LOADED,
-			      CAL_CLIENT_RESULT_INVALID_OBJECT);
+			      CAL_CLIENT_SEND_INVALID_OBJECT);
 
-	g_return_val_if_fail (icalcomp != NULL, CAL_CLIENT_RESULT_INVALID_OBJECT);
+	g_return_val_if_fail (icalcomp != NULL, CAL_CLIENT_SEND_INVALID_OBJECT);
 
 	/* Libical owns this memory, using one of its temporary buffers. */
 	obj_string = icalcomponent_as_ical_string (icalcomp);
@@ -2925,13 +2925,13 @@
 		g_message ("cal_client_update_objects(): could not send the objects");
 		retval = CAL_CLIENT_SEND_CORBA_ERROR;
 	} else {
-		retval = CAL_CLIENT_RESULT_SUCCESS;
+		retval = CAL_CLIENT_SEND_SUCCESS;
 		
 		*new_icalcomp = icalparser_parse_string (obj_string);
 		CORBA_free (obj_string);
 
 		if (*new_icalcomp == NULL) {
-			retval = CAL_CLIENT_RESULT_INVALID_OBJECT;
+			retval = CAL_CLIENT_SEND_INVALID_OBJECT;
 		} else {
 			*users = NULL;
 			for (i = 0; i < user_list->_length; i++)
--- evolution-1.4.6/calendar/gui/e-day-view.c.orig	2004-07-19 22:47:11.012755872 +0200
+++ evolution-1.4.6/calendar/gui/e-day-view.c	2004-07-19 22:50:10.811422320 +0200
@@ -3235,7 +3235,6 @@
 	case GDK_SCROLL_DOWN:
 		e_day_view_scroll (day_view, -E_DAY_VIEW_WHEEL_MOUSE_STEP_SIZE);
 		return TRUE;
-	default:
 	}
 
 	return FALSE;
@@ -3255,7 +3254,6 @@
 	case GDK_SCROLL_DOWN:
 		e_day_view_scroll (day_view, -E_DAY_VIEW_WHEEL_MOUSE_STEP_SIZE);
 		return TRUE;
-	default:
 	}
 
 	return FALSE;
@@ -4142,7 +4140,7 @@
 		const char *uid;
 
 		if (itip_organizer_is_user (event->comp, day_view->client) 
-		    && cancel_component_dialog ((GtkWindow *) gtk_widget_get_toplevel (day_view),
+		    && cancel_component_dialog ((GtkWindow *) gtk_widget_get_toplevel ((GtkWidget *) day_view),
 						day_view->client, event->comp, TRUE))
 			itip_send_comp (CAL_COMPONENT_METHOD_CANCEL, event->comp, day_view->client, NULL);
 
@@ -4279,7 +4277,7 @@
 	e_day_view_on_copy (widget, data);
 
 	if (itip_organizer_is_user (event->comp, day_view->client) 
-	    && cancel_component_dialog ((GtkWindow *) gtk_widget_get_toplevel (day_view),
+	    && cancel_component_dialog ((GtkWindow *) gtk_widget_get_toplevel ((GtkWidget *) day_view),
 					day_view->client, event->comp, TRUE))
 		itip_send_comp (CAL_COMPONENT_METHOD_CANCEL, event->comp, day_view->client, NULL);
 
@@ -4915,7 +4913,7 @@
  		if (recur_component_dialog (comp, &mod, NULL)) {
  			if (cal_client_update_object_with_mod (day_view->client, comp, mod) == CAL_CLIENT_RESULT_SUCCESS) {
  				if (itip_organizer_is_user (comp, day_view->client) &&
-				    send_component_dialog (gtk_widget_get_toplevel (day_view),
+				    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 							   day_view->client, comp, FALSE))
  					itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, day_view->client, NULL);
  			} else {
@@ -4926,7 +4924,7 @@
  		}		
  	} else if (cal_client_update_object (day_view->client, comp) == CAL_CLIENT_RESULT_SUCCESS) {
  		if (itip_organizer_is_user (comp, day_view->client) &&
-		    send_component_dialog (gtk_widget_get_toplevel (day_view),
+		    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 					   day_view->client, comp, TRUE))
   			itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, day_view->client, NULL);
   	} else {
@@ -4997,7 +4995,7 @@
 		if (recur_component_dialog (comp, &mod, NULL)) {
 			if (cal_client_update_object_with_mod (day_view->client, comp, mod) == CAL_CLIENT_RESULT_SUCCESS) {
 				if (itip_organizer_is_user (comp, day_view->client) &&
-				    send_component_dialog (gtk_widget_get_toplevel (day_view),
+				    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 							   day_view->client, comp, FALSE))
 					itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, day_view->client, NULL);
 			} else {
@@ -5008,7 +5006,7 @@
 		}		
 	} else if (cal_client_update_object (day_view->client, comp) == CAL_CLIENT_RESULT_SUCCESS) {
 		if (itip_organizer_is_user (comp, day_view->client) &&
-		    send_component_dialog (gtk_widget_get_toplevel (day_view), day_view->client, comp, FALSE))
+		    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view), day_view->client, comp, FALSE))
 			itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, day_view->client, NULL);
 	} else {
 		g_message ("e_day_view_finish_resize(): Could not update the object!");
@@ -6631,7 +6629,7 @@
 			if (recur_component_dialog (event->comp, &mod, NULL)) {
 				if (cal_client_update_object_with_mod (day_view->client, event->comp, mod) == CAL_CLIENT_RESULT_SUCCESS) {
 					if (itip_organizer_is_user (event->comp, day_view->client) 
-					    && send_component_dialog (gtk_widget_get_toplevel (day_view),
+					    && send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 								      day_view->client, event->comp, FALSE))
 						itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, event->comp, 
 								day_view->client, NULL);
@@ -6641,7 +6639,7 @@
 			}
 		} else if (cal_client_update_object (day_view->client, event->comp) == CAL_CLIENT_RESULT_SUCCESS) {
 			if (itip_organizer_is_user (event->comp, day_view->client) &&
-			    send_component_dialog (gtk_widget_get_toplevel (day_view),
+			    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 						   day_view->client, event->comp, FALSE))
 				itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, event->comp,
 						day_view->client, NULL);
@@ -7747,7 +7745,7 @@
 				if (recur_component_dialog (comp, &mod, NULL)) {
 					if (cal_client_update_object_with_mod (day_view->client, comp, mod) == CAL_CLIENT_RESULT_SUCCESS) {
 						if (itip_organizer_is_user (comp, day_view->client) 
-						    && send_component_dialog (gtk_widget_get_toplevel (day_view),
+						    && send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 									      day_view->client, comp, FALSE))
 							itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, 
 									day_view->client, NULL);
@@ -7759,7 +7757,7 @@
 			} else if (cal_client_update_object (day_view->client, comp)
 			    == CAL_CLIENT_RESULT_SUCCESS) {
 				if (itip_organizer_is_user (comp, day_view->client) &&
-				    send_component_dialog (gtk_widget_get_toplevel (day_view),
+				    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 							   day_view->client, comp, FALSE))
 					itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp,
 							day_view->client, NULL);
@@ -7878,7 +7876,7 @@
 				if (recur_component_dialog (comp, &mod, NULL)) {
 					if (cal_client_update_object_with_mod (day_view->client, comp, mod) == CAL_CLIENT_RESULT_SUCCESS) {
 						if (itip_organizer_is_user (comp, day_view->client) 
-						    && send_component_dialog (gtk_widget_get_toplevel (day_view),
+						    && send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 									      day_view->client, comp, FALSE))
 							itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, 
 									day_view->client, NULL);
@@ -7890,7 +7888,7 @@
 			} else if (cal_client_update_object (day_view->client, comp)
 			    == CAL_CLIENT_RESULT_SUCCESS) {
 				if (itip_organizer_is_user (comp, day_view->client) &&
-				    send_component_dialog (gtk_widget_get_toplevel (day_view),
+				    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view),
 							   day_view->client, comp, FALSE))
 					itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp,
 							day_view->client, NULL);
@@ -8078,7 +8076,7 @@
 		cal_client_update_object (day_view->client, comp);
 
 		if (itip_organizer_is_user (comp, day_view->client) && 
-		    send_component_dialog (gtk_widget_get_toplevel (day_view), day_view->client, comp, TRUE))
+		    send_component_dialog (gtk_widget_get_toplevel ((GtkWidget *) day_view), day_view->client, comp, TRUE))
 			itip_send_comp (CAL_COMPONENT_METHOD_REQUEST, comp, day_view->client, NULL);
 
 		g_object_unref (comp);
--- evolution-1.4.6/mail/message-browser.c.orig	2004-07-19 23:43:18.667794488 +0200
+++ evolution-1.4.6/mail/message-browser.c	2004-07-19 23:43:32.471695976 +0200
@@ -344,7 +344,6 @@
 	case GDK_Escape:
 		message_browser_close (NULL, mb, NULL);
 		return TRUE;	
-	default:
 	}
 	
 	return FALSE;

diff -ur openldap-2.2.18/build/openldap.m4 openldap-2.2.18-t2/build/openldap.m4
--- openldap-2.2.18/build/openldap.m4	2004-04-21 21:16:40.000000000 +0200
+++ openldap-2.2.18-t2/build/openldap.m4	2004-11-08 13:52:57.926367784 +0100
@@ -1259,8 +1259,8 @@
 AC_DEFUN([OL_SASL_COMPAT],
 [AC_CACHE_CHECK([Cyrus SASL library version], [ol_cv_sasl_compat],[
 	AC_EGREP_CPP(__sasl_compat,[
-#ifdef HAVE_SASL_SASL_H
-#include <sasl/sasl.h>
+#ifdef HAVE_SASL2_SASL_H
+#include <sasl2/sasl.h>
 #else
 #include <sasl.h>
 #endif
diff -ur openldap-2.2.18/configure openldap-2.2.18-t2/configure
--- openldap-2.2.18/configure	2004-10-20 20:42:09.000000000 +0200
+++ openldap-2.2.18-t2/configure	2004-11-08 13:53:02.242711600 +0100
@@ -20443,7 +20443,7 @@
 ol_link_sasl=no
 ol_link_spasswd=no
 if test $ol_with_cyrus_sasl != no ; then
-	for ac_hdr in sasl/sasl.h sasl.h
+	for ac_hdr in sasl2/sasl.h sasl.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -20484,7 +20484,7 @@
 done
 
 
-	if test $ac_cv_header_sasl_sasl_h = yes -o $ac_cv_header_sasl_h = yes; then
+	if test $ac_cv_header_sasl2_sasl_h = yes -o $ac_cv_header_sasl_h = yes; then
 		echo $ac_n "checking for sasl_client_init in -lsasl2""... $ac_c" 1>&6
 echo "configure:20490: checking for sasl_client_init in -lsasl2" >&5
 ac_lib_var=`echo sasl2'_'sasl_client_init | sed 'y%./+-:%__p__%'`
@@ -20588,8 +20588,8 @@
 #line 20589 "configure"
 #include "confdefs.h"
 
-#ifdef HAVE_SASL_SASL_H
-#include <sasl/sasl.h>
+#ifdef HAVE_SASL2_SASL_H
+#include <sasl2/sasl.h>
 #else
 #include <sasl.h>
 #endif
diff -ur openldap-2.2.18/configure.in openldap-2.2.18-t2/configure.in
--- openldap-2.2.18/configure.in	2004-07-26 20:15:05.000000000 +0200
+++ openldap-2.2.18-t2/configure.in	2004-11-08 13:53:01.879766776 +0100
@@ -2022,9 +2022,9 @@
 ol_link_sasl=no
 ol_link_spasswd=no
 if test $ol_with_cyrus_sasl != no ; then
-	AC_CHECK_HEADERS(sasl/sasl.h sasl.h)
+	AC_CHECK_HEADERS(sasl2/sasl.h sasl.h)
 
-	if test $ac_cv_header_sasl_sasl_h = yes -o $ac_cv_header_sasl_h = yes; then
+	if test $ac_cv_header_sasl2_sasl_h = yes -o $ac_cv_header_sasl_h = yes; then
 		AC_CHECK_LIB(sasl2, sasl_client_init,
 			[ol_link_sasl="-lsasl2"],
 			[AC_CHECK_LIB(sasl, sasl_client_init,
diff -ur openldap-2.2.18/include/portable.h.in openldap-2.2.18-t2/include/portable.h.in
--- openldap-2.2.18/include/portable.h.in	2004-07-16 20:35:03.000000000 +0200
+++ openldap-2.2.18-t2/include/portable.h.in	2004-11-08 13:52:58.661256064 +0100
@@ -482,8 +482,8 @@
 /* Define if you have the <sasl.h> header file.  */
 #undef HAVE_SASL_H
 
-/* Define if you have the <sasl/sasl.h> header file.  */
-#undef HAVE_SASL_SASL_H
+/* Define if you have the <sasl2/sasl.h> header file.  */
+#undef HAVE_SASL2_SASL_H
 
 /* Define if you have the <sched.h> header file.  */
 #undef HAVE_SCHED_H
diff -ur openldap-2.2.18/libraries/libldap/cyrus.c openldap-2.2.18-t2/libraries/libldap/cyrus.c
--- openldap-2.2.18/libraries/libldap/cyrus.c	2004-08-28 15:35:42.000000000 +0200
+++ openldap-2.2.18-t2/libraries/libldap/cyrus.c	2004-11-08 13:52:59.052196632 +0100
@@ -33,8 +33,8 @@
 ldap_pvt_thread_mutex_t ldap_int_sasl_mutex;
 #endif
 
-#ifdef HAVE_SASL_SASL_H
-#include <sasl/sasl.h>
+#ifdef HAVE_SASL2_SASL_H
+#include <sasl2/sasl.h>
 #else
 #include <sasl.h>
 #endif
diff -ur openldap-2.2.18/libraries/libldap/ldap-int.h openldap-2.2.18-t2/libraries/libldap/ldap-int.h
--- openldap-2.2.18/libraries/libldap/ldap-int.h	2004-01-01 19:16:29.000000000 +0100
+++ openldap-2.2.18-t2/libraries/libldap/ldap-int.h	2004-11-08 13:52:59.060195416 +0100
@@ -32,8 +32,8 @@
 
 #ifdef HAVE_CYRUS_SASL
 	/* the need for this should be removed */
-#ifdef HAVE_SASL_SASL_H
-#include <sasl/sasl.h>
+#ifdef HAVE_SASL2_SASL_H
+#include <sasl2/sasl.h>
 #else
 #include <sasl.h>
 #endif
diff -ur openldap-2.2.18/libraries/liblutil/passwd.c openldap-2.2.18-t2/libraries/liblutil/passwd.c
--- openldap-2.2.18/libraries/liblutil/passwd.c	2004-06-04 05:39:42.000000000 +0200
+++ openldap-2.2.18-t2/libraries/liblutil/passwd.c	2004-11-08 13:52:59.591114704 +0100
@@ -34,8 +34,8 @@
 #include <ac/unistd.h>
 
 #ifdef SLAPD_SPASSWD
-#	ifdef HAVE_SASL_SASL_H
-#		include <sasl/sasl.h>
+#	ifdef HAVE_SASL2_SASL_H
+#		include <sasl2/sasl.h>
 #	else
 #		include <sasl.h>
 #	endif
diff -ur openldap-2.2.18/libraries/liblutil/sasl.c openldap-2.2.18-t2/libraries/liblutil/sasl.c
--- openldap-2.2.18/libraries/liblutil/sasl.c	2004-01-01 19:16:32.000000000 +0100
+++ openldap-2.2.18-t2/libraries/liblutil/sasl.c	2004-11-08 13:52:59.594114248 +0100
@@ -22,8 +22,8 @@
 #include <ac/string.h>
 #include <ac/unistd.h>
 
-#ifdef HAVE_SASL_SASL_H
-#include <sasl/sasl.h>
+#ifdef HAVE_SASL2_SASL_H
+#include <sasl2/sasl.h>
 #else
 #include <sasl.h>
 #endif
diff -ur openldap-2.2.18/servers/slapd/sasl.c openldap-2.2.18-t2/servers/slapd/sasl.c
--- openldap-2.2.18/servers/slapd/sasl.c	2004-09-12 22:22:39.000000000 +0200
+++ openldap-2.2.18-t2/servers/slapd/sasl.c	2004-11-08 13:53:01.401839432 +0100
@@ -27,15 +27,15 @@
 #include <limits.h>
 
 #ifdef HAVE_CYRUS_SASL
-# ifdef HAVE_SASL_SASL_H
-#  include <sasl/sasl.h>
+# ifdef HAVE_SASL2_SASL_H
+#  include <sasl2/sasl.h>
 # else
 #  include <sasl.h>
 # endif
 
 # if SASL_VERSION_MAJOR >= 2
-# ifdef HAVE_SASL_SASL_H
-#  include <sasl/saslplug.h>
+# ifdef HAVE_SASL2_SASL_H
+#  include <sasl2/saslplug.h>
 # else
 #  include <saslplug.h>
 # endif

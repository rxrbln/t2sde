# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../isdn4k-utils/isdn4k-utils.conf
# Copyright (C) 2004 - 2005 The T2 SDE Project
# Copyright (C) 1998 - 2003 ROCK Linux Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- T2-COPYRIGHT-NOTE-END ---

i4l_premake () {
	# Make sure libtool gets recreated to avoid version conflicts
	cd capi20; libtoolize -f -c; cd ..
	export ACLOCAL=aclocal
	export AUTOMAKE=automake
	export AUTOCONF=autoconf

	if [ -z "`type -p xmkmf`" ]; then
		MAKE="$MAKE DESTDIR=$root CONFIG_XISDNLOAD=n CONFIG_XMONISDN=n"
	fi

#	sed -i 's/\(.*CAPICTRL=y.*)/#\1/g' .config.rpm
	cp .config.rpm .config
	touch rcapid/acinclude.m4
	eval $MAKE subconfig
}

i4l_fix_xorg () {
	for subp in xmonisdn xisdnload; do
		sed -i 's,X11R6,X11R7,g' -i $subp/Makefile
	done
}

runconf=0
hook_add premake 5 "i4l_premake"
hook_add premake 6 "i4l_fix_xorg"

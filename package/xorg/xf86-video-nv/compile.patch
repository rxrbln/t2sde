# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../xf86-video-nv/compile.patch
# Copyright (C) 2006 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

Adaptions to build with a non "testing" xorg-server.

  - Rene Rebe <rene@exactcode.de>

diff -ur ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/configure xf86-video-nv-1.1.2/configure
--- ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/configure	2006-04-26 00:02:43.000000000 +0200
+++ xf86-video-nv-1.1.2/configure	2006-04-26 13:46:40.619610000 +0200
@@ -19990,12 +19990,12 @@
         pkg_cv_XORG_CFLAGS="$XORG_CFLAGS"
     else
         if test -n "$PKG_CONFIG" && \
-    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"xorg-server >= 1.0.99.901 xproto fontsproto \$REQUIRED_MODULES\"") >&5
-  ($PKG_CONFIG --exists --print-errors "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES") 2>&5
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"xorg-server >= 1.0.1 xproto fontsproto \$REQUIRED_MODULES\"") >&5
+  ($PKG_CONFIG --exists --print-errors "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  pkg_cv_XORG_CFLAGS=`$PKG_CONFIG --cflags "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES" 2>/dev/null`
+  pkg_cv_XORG_CFLAGS=`$PKG_CONFIG --cflags "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -20008,12 +20008,12 @@
         pkg_cv_XORG_LIBS="$XORG_LIBS"
     else
         if test -n "$PKG_CONFIG" && \
-    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"xorg-server >= 1.0.99.901 xproto fontsproto \$REQUIRED_MODULES\"") >&5
-  ($PKG_CONFIG --exists --print-errors "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES") 2>&5
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"xorg-server >= 1.0.1 xproto fontsproto \$REQUIRED_MODULES\"") >&5
+  ($PKG_CONFIG --exists --print-errors "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; then
-  pkg_cv_XORG_LIBS=`$PKG_CONFIG --libs "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES" 2>/dev/null`
+  pkg_cv_XORG_LIBS=`$PKG_CONFIG --libs "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES" 2>/dev/null`
 else
   pkg_failed=yes
 fi
@@ -20032,14 +20032,14 @@
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        XORG_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES"`
+	        XORG_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES"`
         else
-	        XORG_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES"`
+	        XORG_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES"`
         fi
 	# Put the nasty error message in config.log where it belongs
 	echo "$XORG_PKG_ERRORS" >&5
 
-	{ { echo "$as_me:$LINENO: error: Package requirements (xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES) were not met:
+	{ { echo "$as_me:$LINENO: error: Package requirements (xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES) were not met:
 
 $XORG_PKG_ERRORS
 
@@ -20050,7 +20050,7 @@
 and XORG_LIBS to avoid the need to call pkg-config.
 See the pkg-config man page for more details.
 " >&5
-echo "$as_me: error: Package requirements (xorg-server >= 1.0.99.901 xproto fontsproto $REQUIRED_MODULES) were not met:
+echo "$as_me: error: Package requirements (xorg-server >= 1.0.1 xproto fontsproto $REQUIRED_MODULES) were not met:
 
 $XORG_PKG_ERRORS
 
diff -ur ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/nv_local.h xf86-video-nv-1.1.2/src/nv_local.h
--- ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/nv_local.h	2006-04-14 00:24:15.000000000 +0200
+++ xf86-video-nv-1.1.2/src/nv_local.h	2006-04-26 13:54:19.660298250 +0200
@@ -45,7 +45,9 @@
  * This file includes any environment or machine specific values to access the
  * HW.  Put all affected includes, typdefs, etc. here so the riva_hw.* files
  * can stay generic in nature.
- */ 
+ */
+#include <string.h>
+#include "xf86_ansic.h"
 #include "compiler.h"
 #include "xf86_OSproc.h"
 
diff -ur ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/nv_video.c xf86-video-nv-1.1.2/src/nv_video.c
--- ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/nv_video.c	2006-04-14 00:24:15.000000000 +0200
+++ xf86-video-nv-1.1.2/src/nv_video.c	2006-04-26 13:54:49.122139500 +0200
@@ -4,6 +4,7 @@
 #include "config.h"
 #endif
 
+#include <string.h>
 #include "xf86.h"
 #include "xf86_OSproc.h"
 #include "xf86Resources.h"
diff -ur ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/riva_local.h xf86-video-nv-1.1.2/src/riva_local.h
--- ../src.xf86-video-nv.default.20060426.133056.7854.hammer/xf86-video-nv-1.1.2/src/riva_local.h	2006-04-14 00:24:15.000000000 +0200
+++ xf86-video-nv-1.1.2/src/riva_local.h	2006-04-26 13:58:26.270266250 +0200
@@ -46,6 +46,8 @@
  * HW.  Put all affected includes, typdefs, etc. here so the riva_hw.* files
  * can stay generic in nature.
  */ 
+#include <string.h>
+#include "xf86_ansic.h"
 #include "compiler.h"
 #include "xf86_OSproc.h"
 

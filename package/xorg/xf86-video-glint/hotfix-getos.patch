commit cd3704560a8bfa348fb213870d89ca0bd5f53bb4
Author: Julien Cristau <jcristau@debian.org>
Date:   Mon Jan 23 23:40:28 2017 +0100

    Replace xf86GetOS call with #ifdef
    
    Reviewed-by: Adam Jackson <ajax@redhat.com>
    Signed-off-by: Julien Cristau <jcristau@debian.org>

diff --git a/src/pm2_video.c b/src/pm2_video.c
index 196d222..6d78299 100644
--- a/src/pm2_video.c
+++ b/src/pm2_video.c
@@ -2595,16 +2595,10 @@ Permedia2ReadInput(int fd, pointer unused)
 static Bool
 xvipcOpen(char *name, ScrnInfoPtr pScrn)
 {
-    const char *osname;
-
+#ifdef __linux__
     if (xvipc_fd >= 0)
 	return TRUE;
 
-    xf86GetOS(&osname, NULL, NULL, NULL);
-
-    if (!osname || strcmp(osname, "linux"))
-	return FALSE;
-
     for (;;) {
 	DEBUG(xf86DrvMsgVerb(pScrn->scrnIndex, X_INFO, 2,
 	    "XVIPC probing device %s\n", name));
@@ -2646,6 +2640,7 @@ xvipcOpen(char *name, ScrnInfoPtr pScrn)
 
     xf86DrvMsg(pScrn->scrnIndex, X_WARNING, "Cannot find Permedia 2 kernel driver.\n");
 
+#endif
     return FALSE;
 }
 

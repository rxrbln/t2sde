# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/*/sysvinit/config.in
# Copyright (C) 1998 - 2003 ROCK Linux Project
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

menu_begin MENU_INIT 'Selecting Init'
	# Any package available with INIT flag can be _the_ Init.
	# We will prefer sysvinit, and if no INIT is available a warning
	# will be shown
	# Not being _the_ init doesn't mean the package should be disabled,
	# because it may have usefull tools too.

	CFGTEMP_INIT_DEFAULT=
	CFGTEMP_INIT_LIST=
	CFGTEMP_INIT_AVAILABLE=0

	for x in `grep -e ' INIT ' config/$config/packages | cut -d' ' -f5`; do
		var_append CFGTEMP_INIT_LIST ' ' \
		"$x $x,_$( grep -e '^\[I\]' package/*/$x/$x.desc \
			| cut -d' ' -f2- | tr ' ' '_' )"
		[ "$x" == "$ROCKCFG_INIT" ] && CFGTEMP_INIT_AVAILABLE=1
	done

	if [ -z "$CFGTEMP_INIT_LIST" ]; then
		CFGTEMP_INIT_DEFAULT=none
		CFGTEMP_INIT_LIST="none WARNING:_No_init_was_selected!"
	elif [ $CFGTEMP_INIT_AVAILABLE -eq 0 ]; then
		CFGTEMP_INIT_DEFAULT=$( echo "$CFGTEMP_INIT_LIST" | cut -d' ' -f1 )
	else
		CFGTEMP_INIT_DEFAULT=sysvinit
	fi

	choice ROCKCFG_INIT $CFGTEMP_INIT_DEFAULT $CFGTEMP_INIT_LIST
	
	# default init must get enabled
	[ "$ROCKCFG_INIT" != "none" ] && pkgenable $ROCKCFG_INIT

	comment ' '

	# do package specific config
%include package/*/*/subconfig-init.in

	# FIXME: var name is wrong //mnemoc
	if [ -z "$ROCKCFG_PKG_SYSVINIT_INITSTYLE" ]; then
		comment '-- Select Init Style'
		choice ROCKCFG_PKG_SYSVINIT_INITSTYLE sysv_nice \
				$CFGTEMP_PKG_SYSVINIT_INITSTYLE
	fi
menu_end


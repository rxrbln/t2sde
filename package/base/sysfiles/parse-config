
if [ "$pkg" != "sysfiles" ]; then
	var_append flistdel "|" "etc/mtab"
fi

if [ -f $confdir/postsysfiles.in -a $stagelevel -gt 1 ] ; then
	var_append flistdel "|" "etc/passwd"
	var_append flistdel "|" "etc/shadow"
	var_append flistdel "|" "etc/gshadow"
	hook_add preconf 2 ". $confdir/postsysfiles.in"
fi

# Usage: safe_useradd name uid gid desc homedir shell pass
#
#	uid and name must be registered in
#	Documentation/Developers/REGISTER
#
#	pass is already encrypted and might be one of:
#	"*" ... system account, wont ever have a password
#	"!" ... real user, admin needs to define a password later
#
safe_useradd() {
	if grep -q "^$1:" $root/etc/passwd; then
		echo "Found already existing user '$1'."
	else
		echo "Creating user '$1' ..."
		echo "$1:x:$2:$3:$4:$5" >> $root/etc/passwd
		echo "$1:$6:::::::" >> $root/etc/shadow
	fi
}

# Usage: safe_groupadd name id
#
#	gid and name must be registered in
#	Documentation/Developers/REGISTER
#
safe_groupadd() {
	if grep -q "^$1:" $root/etc/group; then
		echo "Found already existing group '$1'."
	else
		echo "Creating group '$1' ..."
		echo "$1:x:$2:" >> $root/etc/group
	fi
}


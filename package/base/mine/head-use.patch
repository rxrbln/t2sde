--- ./cdb-0.75/Makefile.orig	2003-08-28 13:49:26.000000000 +0200
+++ ./cdb-0.75/Makefile	2004-06-29 21:13:07.375461944 +0200
@@ -12,14 +12,6 @@
 compile alloc.c alloc.h error.h
 	./compile alloc.c
 
-auto_home.c: \
-conf-home
-	./auto-str auto_home `head -1 conf-home` > auto_home.c
-
-auto_home.o: \
-compile auto_home.c
-	./compile auto_home.c
-
 buffer.a: \
 makelib strerr_sys.o buffer.o buffer_put.o buffer_2.o strerr_die.o \
 buffer_get.o buffer_copy.o buffer_1.o buffer_0.o buffer_1s.o
@@ -118,14 +110,14 @@
 cdbmake-12: \
 warn-auto.sh cdbmake-12.sh conf-home
 	cat warn-auto.sh cdbmake-12.sh \
-	| sed s}HOME}"`head -1 conf-home`"}g \
+	| sed s}HOME}"`head -n1 conf-home`"}g \
 	> cdbmake-12
 	chmod 755 cdbmake-12
 
 cdbmake-sv: \
 warn-auto.sh cdbmake-sv.sh conf-home
 	cat warn-auto.sh cdbmake-sv.sh \
-	| sed s}HOME}"`head -1 conf-home`"}g \
+	| sed s}HOME}"`head -n1 conf-home`"}g \
 	> cdbmake-sv
 	chmod 755 cdbmake-sv
 
@@ -159,7 +151,7 @@
 compile: \
 warn-auto.sh conf-cc
 	( cat warn-auto.sh; \
-	echo exec "`head -1 conf-cc`" '-c $${1+"$$@"}' \
+	echo exec "`head -n1 conf-cc`" '-c $${1+"$$@"}' \
 	) > compile
 	chmod 755 compile
 
@@ -175,34 +167,14 @@
 compile fmt_ulong.c fmt.h
 	./compile fmt_ulong.c
 
-hier.o: \
-compile hier.c auto_home.h
-	./compile hier.c
-
-install: \
-load install.o hier.o auto_home.o buffer.a unix.a byte.a
-	./load install hier.o auto_home.o buffer.a unix.a byte.a 
-
-install.o: \
-compile install.c buffer.h strerr.h error.h open.h readwrite.h exit.h
-	./compile install.c
-
-instcheck: \
-load instcheck.o hier.o auto_home.o buffer.a unix.a byte.a
-	./load instcheck hier.o auto_home.o buffer.a unix.a byte.a 
-
-instcheck.o: \
-compile instcheck.c strerr.h error.h readwrite.h exit.h
-	./compile instcheck.c
-
 it: \
-prog install instcheck
+prog 
 
 load: \
 warn-auto.sh conf-ld
 	( cat warn-auto.sh; \
 	echo 'main="$$1"; shift'; \
-	echo exec "`head -1 conf-ld`" \
+	echo exec "`head -n1 conf-ld`" \
 	'-o "$$main" "$$main".o $${1+"$$@"}' \
 	) > load
 	chmod 755 load
@@ -212,7 +184,7 @@
 	( cat warn-auto.sh; \
 	echo 'main="$$1"; shift'; \
 	echo 'rm -f "$$main"'; \
-	echo 'ar cr "$$main" $${1+"$$@"}'; \
+	echo '$(AR) cr "$$main" $${1+"$$@"}'; \
 	case "`cat systype`" in \
 	sunos-5.*) ;; \
 	unix_sv*) ;; \
@@ -221,7 +193,7 @@
 	dgux-*) ;; \
 	hp-ux-*) ;; \
 	sco*) ;; \
-	*) echo 'ranlib "$$main"' ;; \
+	*) echo '$(RANLIB) "$$main"' ;; \
 	esac \
 	) > makelib
 	chmod 755 makelib
@@ -241,7 +213,7 @@
 rts: \
 warn-auto.sh rts.sh conf-home
 	cat warn-auto.sh rts.sh \
-	| sed s}HOME}"`head -1 conf-home`"}g \
+	| sed s}HOME}"`head -n1 conf-home`"}g \
 	> rts
 	chmod 755 rts
 
@@ -257,10 +229,6 @@
 compile seek_set.c seek.h
 	./compile seek_set.c
 
-setup: \
-it install
-	./install
-
 str_len.o: \
 compile str_len.c str.h
 	./compile str_len.c
@@ -276,8 +244,8 @@
 systype: \
 find-systype.sh conf-cc conf-ld trycpp.c x86cpuid.c
 	( cat warn-auto.sh; \
-	echo CC=\'`head -1 conf-cc`\'; \
-	echo LD=\'`head -1 conf-ld`\'; \
+	echo CC=\'`head -n1 conf-cc`\'; \
+	echo LD=\'`head -n1 conf-ld`\'; \
 	cat find-systype.sh; \
 	) | sh > systype
 
--- ./cdb-0.75.patch.orig	2003-08-28 13:49:26.000000000 +0200
+++ ./cdb-0.75.patch	2004-06-29 21:23:09.871868568 +0200
@@ -1,6 +1,6 @@
---- cdb-0.75/Makefile.orig	2002-10-16 13:17:55.000000000 +0200
-+++ cdb-0.75/Makefile	2002-10-16 13:24:44.000000000 +0200
-@@ -12,16 +12,8 @@
+--- cdb-0.75/Makefile.orig	2003-08-28 13:49:26.000000000 +0200
++++ cdb-0.75/Makefile	2004-06-29 21:22:34.983172456 +0200
+@@ -12,22 +12,6 @@
  compile alloc.c alloc.h error.h
  	./compile alloc.c
  
@@ -12,23 +12,140 @@
 -compile auto-str.c buffer.h readwrite.h exit.h
 -	./compile auto-str.c
 -
- auto_home.c: \
+-auto_home.c: \
 -auto-str conf-home
-+conf-home
- 	./auto-str auto_home `head -1 conf-home` > auto_home.c
+-	./auto-str auto_home `head -1 conf-home` > auto_home.c
+-
+-auto_home.o: \
+-compile auto_home.c
+-	./compile auto_home.c
+-
+ buffer.a: \
+ makelib strerr_sys.o buffer.o buffer_put.o buffer_2.o strerr_die.o \
+ buffer_get.o buffer_copy.o buffer_1.o buffer_0.o buffer_1s.o
+@@ -126,14 +110,14 @@
+ cdbmake-12: \
+ warn-auto.sh cdbmake-12.sh conf-home
+ 	cat warn-auto.sh cdbmake-12.sh \
+-	| sed s}HOME}"`head -1 conf-home`"}g \
++	| sed s}HOME}"`head -n1 conf-home`"}g \
+ 	> cdbmake-12
+ 	chmod 755 cdbmake-12
+ 
+ cdbmake-sv: \
+ warn-auto.sh cdbmake-sv.sh conf-home
+ 	cat warn-auto.sh cdbmake-sv.sh \
+-	| sed s}HOME}"`head -1 conf-home`"}g \
++	| sed s}HOME}"`head -n1 conf-home`"}g \
+ 	> cdbmake-sv
+ 	chmod 755 cdbmake-sv
+ 
+@@ -167,7 +151,7 @@
+ compile: \
+ warn-auto.sh conf-cc
+ 	( cat warn-auto.sh; \
+-	echo exec "`head -1 conf-cc`" '-c $${1+"$$@"}' \
++	echo exec "`head -n1 conf-cc`" '-c $${1+"$$@"}' \
+ 	) > compile
+ 	chmod 755 compile
+ 
+@@ -183,34 +167,14 @@
+ compile fmt_ulong.c fmt.h
+ 	./compile fmt_ulong.c
+ 
+-hier.o: \
+-compile hier.c auto_home.h
+-	./compile hier.c
+-
+-install: \
+-load install.o hier.o auto_home.o buffer.a unix.a byte.a
+-	./load install hier.o auto_home.o buffer.a unix.a byte.a 
+-
+-install.o: \
+-compile install.c buffer.h strerr.h error.h open.h readwrite.h exit.h
+-	./compile install.c
+-
+-instcheck: \
+-load instcheck.o hier.o auto_home.o buffer.a unix.a byte.a
+-	./load instcheck hier.o auto_home.o buffer.a unix.a byte.a 
+-
+-instcheck.o: \
+-compile instcheck.c strerr.h error.h readwrite.h exit.h
+-	./compile instcheck.c
+-
+ it: \
+-prog install instcheck
++prog 
+ 
+ load: \
+ warn-auto.sh conf-ld
+ 	( cat warn-auto.sh; \
+ 	echo 'main="$$1"; shift'; \
+-	echo exec "`head -1 conf-ld`" \
++	echo exec "`head -n1 conf-ld`" \
+ 	'-o "$$main" "$$main".o $${1+"$$@"}' \
+ 	) > load
+ 	chmod 755 load
+@@ -220,7 +184,7 @@
+ 	( cat warn-auto.sh; \
+ 	echo 'main="$$1"; shift'; \
+ 	echo 'rm -f "$$main"'; \
+-	echo 'ar cr "$$main" $${1+"$$@"}'; \
++	echo '$(AR) cr "$$main" $${1+"$$@"}'; \
+ 	case "`cat systype`" in \
+ 	sunos-5.*) ;; \
+ 	unix_sv*) ;; \
+@@ -229,7 +193,7 @@
+ 	dgux-*) ;; \
+ 	hp-ux-*) ;; \
+ 	sco*) ;; \
+-	*) echo 'ranlib "$$main"' ;; \
++	*) echo '$(RANLIB) "$$main"' ;; \
+ 	esac \
+ 	) > makelib
+ 	chmod 755 makelib
+@@ -249,7 +213,7 @@
+ rts: \
+ warn-auto.sh rts.sh conf-home
+ 	cat warn-auto.sh rts.sh \
+-	| sed s}HOME}"`head -1 conf-home`"}g \
++	| sed s}HOME}"`head -n1 conf-home`"}g \
+ 	> rts
+ 	chmod 755 rts
+ 
+@@ -265,10 +229,6 @@
+ compile seek_set.c seek.h
+ 	./compile seek_set.c
+ 
+-setup: \
+-it install
+-	./install
+-
+ str_len.o: \
+ compile str_len.c str.h
+ 	./compile str_len.c
+@@ -284,8 +244,8 @@
+ systype: \
+ find-systype.sh conf-cc conf-ld trycpp.c x86cpuid.c
+ 	( cat warn-auto.sh; \
+-	echo CC=\'`head -1 conf-cc`\'; \
+-	echo LD=\'`head -1 conf-ld`\'; \
++	echo CC=\'`head -n1 conf-cc`\'; \
++	echo LD=\'`head -n1 conf-ld`\'; \
+ 	cat find-systype.sh; \
+ 	) | sh > systype
  
- auto_home.o: \
---- cdb-0.75/auto-str.c.orig	2002-10-16 13:13:48.000000000 +0200
-+++ cdb-0.75/auto-str.c	2002-10-16 13:24:44.000000000 +0200
+--- cdb-0.75/auto-str.c.orig	2003-08-28 13:49:26.000000000 +0200
++++ cdb-0.75/auto-str.c	2004-06-29 21:22:31.457708408 +0200
 @@ -1,15 +1,6 @@
 -#include "buffer.h"
 -#include "readwrite.h"
 -#include "exit.h"
--
--char buf1[256];
--buffer ss1 = BUFFER_INIT(write,1,buf1,sizeof(buf1));
 +#include <stdio.h>
  
+-char buf1[256];
+-buffer ss1 = BUFFER_INIT(write,1,buf1,sizeof(buf1));
+-
 -void puts(s)
 -char *s;
 -{
@@ -46,22 +163,22 @@
 -  _exit(0);
 +  return 0;
  }
---- cdb-0.75/conf-cc.orig	2002-09-16 18:31:49.000000000 +0200
-+++ cdb-0.75/conf-cc	2002-09-16 18:28:35.000000000 +0200
+--- cdb-0.75/conf-cc.orig	2003-08-28 13:49:26.000000000 +0200
++++ cdb-0.75/conf-cc	2004-06-29 21:22:31.457708408 +0200
 @@ -1,3 +1,3 @@
 -gcc -O2
 +${CC:-gcc} -O2
  
  This will be used to compile .c files.
---- cdb-0.75/conf-ld.orig	2002-09-16 18:31:49.000000000 +0200
-+++ cdb-0.75/conf-ld	2002-09-16 18:28:35.000000000 +0200
+--- cdb-0.75/conf-ld.orig	2003-08-28 13:49:26.000000000 +0200
++++ cdb-0.75/conf-ld	2004-06-29 21:22:31.458708256 +0200
 @@ -1,3 +1,3 @@
 -gcc -s
 +${CC:-gcc} -s
  
  This will be used to link .o files into an executable.
---- cdb-0.75/error.h.orig	2003-03-09 12:41:26.000000000 +0100
-+++ cdb-0.75/error.h	2003-03-09 12:41:26.000000000 +0100
+--- cdb-0.75/error.h.orig	2003-08-28 13:49:26.000000000 +0200
++++ cdb-0.75/error.h	2004-06-29 21:22:31.459708104 +0200
 @@ -1,7 +1,7 @@
  #ifndef ERROR_H
  #define ERROR_H

# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/base/gcc3/config-300.in
# ROCK Linux is Copyright (C) 1998 - 2003 Clifford Wolf
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

menu_begin MENU_COMPILER 'Selecting compiler'
	default='' ; list=''
	while read pkg ver ; do
		default=${default:-$pkg} ; [ $pkg = gcc3 ] && default=gcc3
		list="$list $pkg Use_${pkg}_($ver)_as_standard_C_compiler"
	done < <(grep "^X .* CC " config/$config/packages | cut -f5,6 -d' ')
	if [ -z "$default" ] ; then
		default="cc" ; list="cc Standard_C-Compiler_CC"
	fi
	choice ROCKCFG_DEFAULT_CC $default $list

	# do not build non-default gcc on stages 0 or 1
	if [ "$ROCKCFG_DEFAULT_CC" != "gcc2" ]; then
		pkgfilter sed -e '/ gcc2 / s/^\(..\)../\1--/' 
	fi
	if [ "$ROCKCFG_DEFAULT_CC" != "gcc3" ]; then
		pkgfilter sed -e '/ gcc3 / s/^\(..\)../\1--/' 
	fi
	if [ "$ROCKCFG_DEFAULT_CC" != "gcc33" ]; then
		pkgfilter sed -e '/ gcc33 / s/^\(..\)../\1--/' 
	fi
	if [ "$ROCKCFG_DEFAULT_CC" != "gccx" ]; then
		pkgfilter sed -e '/ gccx / s/^\(..\)../\1--/' 
	fi

	default='' ; list=''
	while read pkg ver ; do
		default=${default:-$pkg} ; [ $pkg = gcc3 ] && default=gcc3
		list="$list $pkg Use_${pkg}_($ver)_as_kernel_C_compiler"
	done < <(grep "^X .* KCC " config/$config/packages | cut -f5,6 -d' ')
	if [ -z "$default" ] ; then
		default="kcc" ; list="kcc Standard_Kernel_C-Compiler_KCC"
	fi
	choice ROCKCFG_DEFAULT_KCC $default $list

	default='' ; list=''
	while read pkg ver ; do
		default=${default:-$pkg} ; [ $pkg = gcc3 ] && default=gcc3
		list="$list $pkg Use_${pkg}_($ver)_as_standard_C++_compiler"
	done < <(grep "^X .* CXX " config/$config/packages | cut -f5,6 -d' ')
	if [ -z "$default" ] ; then
		default="c++" ; list="c++ Standard_C++-Compiler_C++"
	fi
	choice ROCKCFG_DEFAULT_CXX $default $list

	default='' ; list=''
	while read pkg ver ; do
		default=${default:-$pkg} ; [ $pkg = gcc3 ] && default=gcc3
		list="$list $pkg Use_${pkg}_($ver)_as_standard_F77_compiler"
	done < <(grep "^X .* F77 " config/$config/packages | cut -f5,6 -d' ')
	if [ -z "$default" ] ; then
		default="f77" ; list="f77 Standard_Fortran-Compiler_F77"
	fi
	choice ROCKCFG_DEFAULT_F77 $default $list
menu_end

if pkgcheck gcc3 X && pkgcheck gcc33 X; then
	comment ' '
	comment 'WARNING: gcc3 and gcc33 are not designed to work together!!'
	comment 'WARNING: please disable one of them.'
fi

if pkgcheck "gcc2|gcc3|gcc33|gccx" X; then

	menu_begin MENU_PKG_GCC 'GCC (GNU Compiler Collection) options'
		bool 'Use Stack-Smashing Protector when available' \
					ROCKCFG_PKG_GCC_STACKPRO 0
		%include package/*/*/subconfig-gcc.in
		
		if pkgcheck gcc2 X; then
			comment ' '
			comment '--- GCC 2.x options'
			bool 'Do not build CHILL compiler' \
					ROCKCFG_PKG_GCC2_NO_CHILL 0
			%include package/*/*/subconfig-gcc2.in
		fi
		if pkgcheck gcc3 X; then
			comment ' '
			comment '--- GCC 3.2.x options'
			bool 'Do not build JAVA compiler' \
					ROCKCFG_PKG_GCC3_NO_JAVA 0
			%include package/*/*/subconfig-gcc3.in
		fi
		if pkgcheck gcc33 X; then
			comment ' '
			comment '--- GCC 3.3.x options'
			bool 'Do not build JAVA compiler' \
					ROCKCFG_PKG_GCC33_NO_JAVA 0
			%include package/*/*/subconfig-gcc33.in
		fi
		if pkgcheck gccx X; then
			comment ' '
			comment '--- GCC-snapshot options'
			bool 'Do not build JAVA compiler' \
					ROCKCFG_PKG_GCCX_NO_JAVA 0
			%include package/*/*/subconfig-gccx.in
		fi

	menu_end
fi


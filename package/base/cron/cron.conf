# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: package/*/cron/cron.conf
# Copyright (C) 2004 - 2021 The T2 SDE Project
# Copyright (C) 1998 - 2003 ROCK Linux Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

crondiff=`match_source_file -p diff`
[ -z "$crondiff" ] || var_insert patchfiles ' ' "$crondiff"

cron_inst() {
	cp $confdir/crontab $root/etc/
	chmod 600  $root/etc/crontab
	cp $confdir/cron.run.sh $root/usr/sbin/cron.run
	chmod +x $root/usr/sbin/cron.run

	# prepare crontabs dir for normal users (crontab -e)
	mkdir -p $root/var/spool/cron/crontabs
	chmod a+rx $root/var/spool/cron
	chmod 1730 $root/var/spool/cron/crontabs
	chgrp 53 $root/$prefix/bin/crontab $root/var/spool/cron/crontabs
	chmod u-s,g+s $root/$prefix/bin/crontab
}

hook_add postmake 5 'cron_inst'

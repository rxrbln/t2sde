# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../dietlibc/pkg_patch/pkg_gcc.chroot.patch
# Copyright (C) 2004 - 2005 The T2 SDE Project
# Copyright (C) 1998 - 2004 ROCK Linux Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

diff -Nur gcc-3.2.3.orig/gcc/Makefile.in gcc-3.2.3/gcc/Makefile.in
--- gcc-3.2.3.orig/gcc/Makefile.in	Tue Jan 28 22:54:07 2003
+++ gcc-3.2.3/gcc/Makefile.in	Tue Jun  3 23:18:27 2003
@@ -232,9 +232,9 @@
 FIBHEAP_H   = $(srcdir)/../include/fibheap.h
 
 # Default native SYSTEM_HEADER_DIR, to be overridden by targets.
-NATIVE_SYSTEM_HEADER_DIR = /usr/include
+NATIVE_SYSTEM_HEADER_DIR = /usr/dietlibc/include
 # Default cross SYSTEM_HEADER_DIR, to be overridden by targets.
-CROSS_SYSTEM_HEADER_DIR = $(build_tooldir)/sys-include
+CROSS_SYSTEM_HEADER_DIR = /usr/dietlibc/include
 
 # autoconf sets SYSTEM_HEADER_DIR to one of the above.
 SYSTEM_HEADER_DIR = @SYSTEM_HEADER_DIR@
diff -Nur gcc-3.2.3.orig/gcc/config/linux.h gcc-3.2.3/gcc/config/linux.h
--- gcc-3.2.3.orig/gcc/config/linux.h	Tue Dec 18 11:42:32 2001
+++ gcc-3.2.3/gcc/config/linux.h	Thu Jun  5 19:46:50 2003
@@ -46,22 +46,10 @@
    object constructed before entering `main'. */
    
 #undef	STARTFILE_SPEC
-#ifdef USE_GNULIBC_1
 #define STARTFILE_SPEC \
-  "%{!shared: \
-     %{pg:gcrt1.o%s} %{!pg:%{p:gcrt1.o%s} \
-		       %{!p:%{profile:gcrt1.o%s} \
-			 %{!profile:crt1.o%s}}}} \
-   crti.o%s %{!shared:crtbegin.o%s} %{shared:crtbeginS.o%s}"
-#else
-#define STARTFILE_SPEC \
-  "%{!shared: \
-     %{pg:gcrt1.o%s} %{!pg:%{p:gcrt1.o%s} \
-		       %{!p:%{profile:gcrt1.o%s} \
-			 %{!profile:crt1.o%s}}}} \
-   crti.o%s %{static:crtbeginT.o%s}\
-   %{!static:%{!shared:crtbegin.o%s} %{shared:crtbeginS.o%s}}"
-#endif
+  "start.o%s"
+/*  "%{!shared:start.o%s}\
+   %{shared:shared_not_yet_set_in_STARTFILE_SPEC.o%s}"*/
 
 /* Provide a ENDFILE_SPEC appropriate for GNU/Linux.  Here we tack on
    the GNU/Linux magical crtend.o file (see crtstuff.c) which
@@ -71,8 +59,9 @@
 
 #undef	ENDFILE_SPEC
 #define ENDFILE_SPEC \
-  "%{!shared:crtend.o%s} %{shared:crtendS.o%s} crtn.o%s"
-
+  ""
+/*"%{!shared:crtend.o%s} %{shared:crtendS.o%s} crtn.o%s"
+*/
 /* This is for -profile to use -lc_p instead of -lc. */
 #ifndef CC1_SPEC
 #define CC1_SPEC "%{profile:-p}"
diff -Nur gcc-3.2.3.orig/gcc/cppdefault.h gcc-3.2.3/gcc/cppdefault.h
--- gcc-3.2.3.orig/gcc/cppdefault.h	Sun Oct  7 18:50:51 2001
+++ gcc-3.2.3/gcc/cppdefault.h	Tue Jun  3 23:19:22 2003
@@ -27,7 +27,7 @@
    tradcpp.  */
 
 #ifndef STANDARD_INCLUDE_DIR
-#define STANDARD_INCLUDE_DIR "/usr/include"
+#define STANDARD_INCLUDE_DIR "/usr/dietlibc/include"
 #endif
 
 #ifndef STANDARD_INCLUDE_COMPONENT
diff -Nur gcc-3.2.3.orig/gcc/gcc.c gcc-3.2.3/gcc/gcc.c
--- gcc-3.2.3.orig/gcc/gcc.c	Wed Jun  4 11:55:54 2003
+++ gcc-3.2.3/gcc/gcc.c	Thu Jun  5 20:04:26 2003
@@ -1340,6 +1340,7 @@
 static const char *const standard_startfile_prefix = STANDARD_STARTFILE_PREFIX;
 static const char *const standard_startfile_prefix_1 = "/lib/";
 static const char *const standard_startfile_prefix_2 = "/usr/lib/";
+static const char *const standard_startfile_prefix_3 = "/usr/dietlibc/lib-i386/";
 
 static const char *const tooldir_base_prefix = TOOLDIR_BASE_PREFIX;
 static const char *tooldir_prefix;
@@ -5976,6 +5977,8 @@
       add_prefix (&startfile_prefixes, standard_startfile_prefix_1,
 		  "BINUTILS", PREFIX_PRIORITY_LAST, 0, NULL, 1);
       add_prefix (&startfile_prefixes, standard_startfile_prefix_2,
+		  "BINUTILS", PREFIX_PRIORITY_LAST, 0, NULL, 1);
+      add_prefix (&startfile_prefixes, standard_startfile_prefix_3,
 		  "BINUTILS", PREFIX_PRIORITY_LAST, 0, NULL, 1);
 #if 0 /* Can cause surprises, and one can use -B./ instead.  */
       add_prefix (&startfile_prefixes, "./", NULL,

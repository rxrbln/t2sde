#!/bin/sh
# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../dietlibc/subconfig-libc.in
# Copyright (C) 2004 - 2005 The T2 SDE Project
# Copyright (C) 1998 - 2004 ROCK Linux Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- T2-COPYRIGHT-NOTE-END ---

if [ "$ROCKCFG_LIBC" == "dietlibc" ]; then
	ROCKCFGSET_DIETLIBC=1
fi

if pkgcheck dietlibc X
then
  comment 'Dietlibc Options'
	bool 'Enable dietlibc support' ROCKCFG_DIETLIBC 0
	if [ $ROCKCFG_DIETLIBC = 1 ] ; then
		menu_begin MENU_PKG_DIETLIBC_FEATURES 'Special features'
			bool 'WANT_SYSENTER' \
				ROCKCFG_DIETWANT_SYSENTER 1
		menu_end
		bool 'Link binaries dynamically with dietlibc' \
						ROCKCFG_DIETLIBC_DYN 0
						
		if [ $ROCKCFG_LIBC != dietlibc ]; then
			block_begin 2
			pkgout
			for i in `grep " DIETLIBC " config/$config/packages | \
					cut -f5 -d" " | sort`
			do
				x="${i//-/_}" ; x="${x//+/_}"
				bool "Build package with dietlibc: $i" \
				     "ROCKCFG_DIETLIBC_${x}" 0
			done
			block_end
		fi
	fi
  comment ' '
fi


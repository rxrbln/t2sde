# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by scripts/Create-CopyPatch.
# 
# T2 SDE: package/*/libreoffice/libreoffice.conf
# Copyright (C) 2004 - 2021 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- T2-COPYRIGHT-NOTE-END ---

if [ $prefix_auto = 1 ]; then
	prefix=/opt/openoffice.org
	set_confopt
fi

ooo_lang='en-US' # de es fr it' #ALL

#var_append confopt ' ' '--disable-fetch-external'
var_append confopt ' ' "--with-parallelism=$SDECFG_PARALLEL_MAX \
--disable-extension-integration \
--disable-avmedia \
--disable-database-connectivity \
--disable-extensions \
--disable-scripting \
--disable-dynamic-loading \
--disable-report-builder \
--disable-lpsolve \
--disable-coinmp \
--disable-pdfimport \
--disable-pdfium \
--disable-skia \
--disable-crashdump \
--disable-gtk3 \
--disable-cairo-canvas \
--disable-dbus \
--disable-sdremote \
--disable-sdremote-bluetooth \
--disable-gio \
--disable-gstreamer-1-0 \
--disable-ccache \
--disable-extension-update \
--disable-X-community-flavor \
--disable-mariadb-sdbc \
--disable-postgresql-sdbc \
--disable-lotuswordpro \
--disable-firebird-sdbc \
--disable-nss \
--disable-dconf \
--disable-ldap \
--disable-opencl \
--disable-librelogo \
--disable-cmis \
--disable-poppler \
--disable-gpgmepp \
--disable-scripting-beanshell \
--disable-scripting-javascript \
--disable-zxing \
--with-system-X-libs \
--with-system-bzip2 \
--with-system-X-headers \
--with-system-cairo \
--with-system-epoxy \
--with-system-zlib \
--with-system-jpeg \
--with-system-clucene \
--with-system-expat \
--with-system-libxml \
--with-system-icu \
--with-system-X-ucpp \
--with-system-openldap \
--with-system-poppler \
--with-system-gpgmepp \
--with-system-X-mariadb \
--with-system-X-postgresql \
--with-system-X-firebird \
--with-system-libtommath \
--with-system-X-hsqldb \
--with-system-X-beanshell \
--with-system-X-rhino \
--with-system-X-jfreereport \
--with-system-X-odbc \
--with-system-sane \
--with-system-bluez \
--with-system-curl \
--with-system-boost \
--with-system-X-glm \
--with-system-X-hunspell \
--with-system-X-zxing \
--with-system-X-box2d \
--with-system-X-mythes \
--with-system-X-altlinuxhyph \
--with-system-X-lpsolve \
--with-system-X-coinmp \
--with-system-X-liblangtag \
--with-system-icu-for-build=yes \
--with-system-X-libcmis \
--with-system-expat \
--with-system-xmlsec \
--with-system-X-libeot \
--with-system-X-librevenge \
--with-system-X-libodfgen \
--with-system-X-libepubgen \
--with-system-X-libwpd \
--with-system-X-libwpg \
--with-system-X-libwps \
--with-system-X-libvisio \
--with-system-X-libcdr \
--with-system-X-libmspub \
--with-system-X-libmwaw \
--with-system-X-libetonyek \
--with-system-X-libfreehand \
--with-system-X-libebook \
--with-system-X-libabw \
--with-system-X-libpagemaker \
--with-system-X-libqxp \
--with-system-X-libzmf \
--with-system-X-libstaroffice \
--with-system-lcms2 \
--with-system-cppunit \
--with-system-libatomic_ops \
--with-system-X-mdds \
--with-system-nss \
--with-system-X-orcus \
--with-system-X-graphite \
--with-system-harfbuzz \
--with-system-apr \
--with-system-serf \
--with-system-neon \
--with-system-openssl \
--with-system-X-redland \
--with-system-X-libexttextcat \
--with-system-X-libnumbertext \
--with-system-epoxy \
--with-system-libpng"

var_append confopt ' ' '--with-binsuffix=no' # just one OpenOffice for now
var_append confopt ' ' '--with-installed-ooo-dirname=openoffice.org'
var_append confopt ' ' "--with-docdir=$docdir"

var_append confopt ' ' '--disable-post-install-scripts'
var_append confopt ' ' '--disable-binfilter'
# requires some prebuilt .dll or mingw around - for windows registry mangling
var_append confopt ' ' '--disable-odk'
var_append confopt ' ' '--disable-gstreamer-1-0'

# instead of --with-internal-gcc
var_append confopt ' ' "--with-system-gcc"

# UI language
var_append confopt ' ' "'--with-lang=\"\$ooo_lang\"'"
var_append confopt ' ' "'--with-dict=\"\$ooo_lang\"'"

# Widgets and Icons
#
ooo_iconset=

# GNOME support
if pkginstalled gtk+2; then
	var_append confopt ' ' "--enable-gtk"
	if pkginstalled libbonobo; then
		var_append confopt ' ' "--with-bonobo"
	fi
	[ "$SDECFG_PKG_OOO_ICONS_GNOME" = "1" ] &&
		var_append ooo_iconset ',' "gnome"
else
	var_append confopt ' ' "--disable-gtk"
fi

var_append confopt ' ' "--disable-kde"

if ! pkginstalled gnome-vfs; then
	var_append confopt ' ' '--disable-gnome-vfs'
fi

if pkginstalled openldap; then
	var_append GCC_WRAPPER_APPEND ' ' "-I`pkgprefix includedir openldap`"
	var_append GCC_WRAPPER_APPEND ' ' "-L`pkgprefix libdir openldap`"
else
	var_append confopt ' ' '--disable-ldap'
fi

# disable cairo support, for now
var_append confopt ' ' "--enable-cairo=no"
# disable mdb/access support, for now
var_append confopt ' ' "--enable-access=no"
# disable mono support, for now
var_append confopt ' ' "--enable-mono=no"

#FIXME: download location [ "$SDECFG_PKG_OOO_ICONS_BLUECURVE" = "1" ] && var_append ooo_iconset ',' "Bluecurve"
[ -n "$ooo_iconset" ] && var_append confopt ' ' "--with-icons=$ooo_iconset"

# Architecture
cpu="`echo $arch | arch2uname`"
var_append confopt ' ' "--with-arch=$cpu"

var_append confopt ' ' "--without-gpc --enable-crashdump=no --disable-crashdump --disable-binfilter --disable-epm"

var_append confopt ' ' "--with-system-db --with-db-version=4.3"

var_append confopt ' ' "--enable-fontconfig --without-myspell-dicts --without-fonts"
var_append confopt ' ' "--disable-mozilla --without-gssapi"

# build fails otherwise
var_append confopt ' ' "--enable-vba --with-vba-package-format=builtin"

pkginstalled boost && var_append confopt ' ' "--with-system-boost"
pkginstalled heimdal || var_append confopt ' ' "--without-krb5"

pkginstalled startup-notification && var_append confopt ' ' "--enable-libsn"

pkginstalled libsndfile && var_append confopt ' ' "--with-system-sndfile"

if pkginstalled nas; then
       	var_append confopt ' ' "--with-system-nas"
	export LDFLAGS=-L`pkgprefix libdir libx11`
	export CFLAGS=-I/usr/X11/include
	export CPPFLAGS=-I/usr/X11/include
else
	var_append confopt ' ' "--without-nas"
fi

if [[ $libdir == *lib64 ]]; then
	var_append confopt ' '  "--enable-64bit-libs=yes"
fi

# Java support
var_append confopt ' ' "--without-java"

var_append GCC_WRAPPER_APPEND ' ' "`pkg-config --cflags --libs-only-L x11`"

# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../ooo/hotfix_libwpd.patch
# Copyright (C) 2004 - 2005 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

--- ./Makefile.in.orig	2005-10-25 15:17:19.000000000 -0300
+++ ./Makefile.in	2005-11-05 11:00:34.000000000 -0300
@@ -692,7 +694,6 @@
 $(STAMP_DIR)/patch.apply : $(top_srcdir)/patches/apply.pl \
 			   $(top_srcdir)/patches/*/*.diff \
 			   $(APPLY_DIR)/apply
-	cp -f $(SRCDIR)/libwpd-0*.tar.gz $(OOBUILDDIR)/libwpd/download/ || echo "cannot copy libwpd"
 	if test "z$(BUILD_WIN32)" != "z"; then \
 	    cp -af $(BUILDDIR)/x86/* $(OOBUILDDIR)/external/dbghelp || true; \
 	    cp -af $(BUILDDIR)/*.dll $(OOBUILDDIR)/external/unicows || true; \
--- ./Makefile.shared.orig	2005-10-20 06:58:03.000000000 -0300
+++ ./Makefile.shared	2005-11-05 11:00:50.000000000 -0300
@@ -45,7 +47,6 @@
 $(STAMP_DIR)/patch.apply : $(top_srcdir)/patches/apply.pl \
 			   $(top_srcdir)/patches/*/*.diff \
 			   $(APPLY_DIR)/apply
-	cp -f $(SRCDIR)/libwpd-0*.tar.gz $(OOBUILDDIR)/libwpd/download/ || echo "cannot copy libwpd"
 	if test "z$(BUILD_WIN32)" != "z"; then \
 	    cp -af $(BUILDDIR)/x86/* $(OOBUILDDIR)/external/dbghelp || true; \
 	    cp -af $(BUILDDIR)/*.dll $(OOBUILDDIR)/external/unicows || true; \
--- ./bin/unpack.orig	2005-11-05 13:00:31.000000000 -0300
+++ ./bin/unpack	2005-11-05 13:08:14.000000000 -0300
@@ -257,6 +257,11 @@
     cp -a $SRCDIR/$MDBTOOLS_SRC $MDBDEST || exit 1;
 fi
 
+echo "Copying libwpd into the tree"
+mkdir -p $OOBUILDDIR/libwpd/download/
+rm -f $OOBUILDDIR/libwpd/download/libwpd-*
+cp -a $SRCDIR/libwpd-0*.tar.bz2 $OOBUILDDIR/libwpd/download/
+
 echo "Copying default evolution database into tree"
 cp -af $TOOLSDIR/src/evolocal.odb $OOBUILDDIR/extras/source/database || exit 1;
 
--- /dev/null	2005-10-02 21:55:15.000000000 -0400
+++ ./patches/src680/unpack_libwpd.diff	2005-11-05 15:05:57.000000000 -0300
@@ -0,0 +1,9 @@
+--- libwpd/makefile.mk.orig	2005-11-05 15:03:00.000000000 -0300
++++ libwpd/makefile.mk	2005-11-05 15:02:49.000000000 -0300
+@@ -54,0 +54,6 @@
++
++./$(INPATH)/misc/$(TARFILE_NAME).unpack: ./download/$(TARFILE_NAME).tar.bz2
++	mkdir -p $(INPATH)/misc/build
++	tar -C $(INPATH)/misc/build -jxf $<
++	touch $*
++

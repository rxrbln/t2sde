# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../openoffice-org/openoffice.org-3.1.1.ooo104157.svx.crashonencryptparse.patch
# Copyright (C) 2009 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

--- ./svx.orig/source/svdraw/svdfppt.cxx	2009-08-27 17:13:39.000000000 +0100
+++ ./svx/source/svdraw/svdfppt.cxx	2009-08-27 17:13:43.000000000 +0100
@@ -1429,9 +1429,11 @@
     ePageColorsKind		( PPT_MASTERPAGE ),
     eAktPageKind		( PPT_MASTERPAGE )
 {
-	DffRecordHeader* pHd;
+    if (rParam.aCurrentUserAtom.nMagic == 0xF3D1C4Df) //encrypted                                               â”‚
+        bOk = false;          
     if ( bOk )
 	{
+	    DffRecordHeader* pHd;
         rStCtrl.Seek( STREAM_SEEK_TO_END );
         nStreamLen = rStCtrl.Tell();
 

--- netpbm-10.12/buildtools/installnetpbm.pl.orig	2004-03-03 11:10:51.000000000 +0100
+++ netpbm-10.12/buildtools/installnetpbm.pl	2004-03-03 12:03:52.000000000 +0100
@@ -140,13 +140,12 @@
 
     if (`cp --version 2>/dev/null` =~ m/GNU/) {
         # It's GNU Cp -- we have options galore, and they're readable.
-        $cpCommand = "cp --recursive --preserve --no-dereference";
+        $cpCommand = "cp --preserve --no-dereference";
     } else {
         # This works on Cp from "4th Berkeley Distribution", July 1994.
         # Mac OSX has this.
-        # -R means recursive with no dereferencing of symlinks
         # -p means preserve attributes
-        $cpCommand = "cp -R -p";
+        $cpCommand = "cp -p -d";
     }
     return($cpCommand);
 }
@@ -662,8 +661,30 @@
 }
 
 
+sub installManPages($$) {
+  
+  my ($srcdir, $dstdir) = @_;
+
+  if (! -d ($dstdir)) {
+    my $succeeded = mkdir($dstdir, 0777);
+
+    if (!$succeeded) {
+      print("Unable to create directory '$dstdir'.  " .
+	    "Error=$ERRNO\n");
+      return;
+    } 
+  }
 
-sub installManPage($$) {
+  my $rc = system("$cpCommand $srcdir/* $dstdir/");
+
+  if ($rc != 0) {
+        print("copy of man pages from $srcdir to $dstdir failed.\n");
+        print("cp exit code is $rc\n");
+      }
+}
+
+
+sub installManDirectories($$) {
 
 
 # Note: This installs the pointer man pages and the netpbm.url file for Manweb.
@@ -674,16 +695,11 @@
 
     print("Installing man pages...\n");
 
-    my $rc = system("$cpCommand $pkgdir/man/* $manDir/");
-
-    if ($rc != 0) {
-        print("copy of man pages from $pkgdir/man to $manDir failed.\n");
-        print("cp exit code is $rc\n");
-    } else {
-        print("done.\n");
-    }
+    installManPages("$pkgdir/man/man1", "$manDir/man1");
+    installManPages("$pkgdir/man/man3", "$manDir/man3");
+    installManPages("$pkgdir/man/man5", "$manDir/man5");
 
-    print("\n");
+    print("done\n");
 
     removeObsoleteManPage($manDir);
 
@@ -730,7 +746,7 @@
 installHeader($pkgdir, $prefix);
 print("\n");
 
-installManPage($pkgdir, $prefix);
+installManDirectories($pkgdir, $prefix);
 print("\n");
 
 print("Installation is complete (except where previous error messages have\n");

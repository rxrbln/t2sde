
# this builds the matching nvidia kernel modules for the building kernel

main() {
	sh $archdir/NVIDIA-Linux-x86-${ver}-pkg1.run --extract-only
	cd NVIDIA-Linux-x86-${ver}-pkg1

	apply_patchfiles

	cd usr/src/nv
	var_append makeopt " " "SYSSRC=$kerneldir KERNEL_MODLIB=$moduledir"
	var_append makeopt " " "KERNEL_UNAME=$lx_kernelrelease"
	var_append makeopt " " "MODULE_ROOT=$moduledir"
	echo $MAKE $makeopt module
	eval $MAKE $makeopt module
	if [[ $treever = 24* ]] ; then
		echo $MAKE $makeopt package-install
		eval $MAKE $makeopt package-install
	else
		echo $MAKE $makeopt module-install
		eval $MAKE $makeopt module-instal
	fi
}

autoextract=0
custmain=main


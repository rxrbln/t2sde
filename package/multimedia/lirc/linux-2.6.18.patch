# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../lirc/linux-2.6.18.patch
# Copyright (C) 2006 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- T2-COPYRIGHT-NOTE-END ---

diff -Nur lirc-0.8.0-orig/drivers/kcompat.h lirc-0.8.0/drivers/kcompat.h
--- lirc-0.8.0-orig/drivers/kcompat.h	2006-01-07 22:51:31.000000000 +0200
+++ lirc-0.8.0/drivers/kcompat.h	2006-09-20 21:19:31.000000000 +0300
@@ -9,8 +9,11 @@
 
 #include <linux/device.h>
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,18)
 #define LIRC_HAVE_DEVFS
 #define LIRC_HAVE_DEVFS_26
+#endif
+
 #define LIRC_HAVE_SYSFS
 
 #if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,13)
diff -Nur lirc-0.8.0-orig/drivers/lirc_dev/lirc_dev.c lirc-0.8.0/drivers/lirc_dev/lirc_dev.c
--- lirc-0.8.0-orig/drivers/lirc_dev/lirc_dev.c	2005-12-03 17:18:07.000000000 +0200
+++ lirc-0.8.0/drivers/lirc_dev/lirc_dev.c	2006-09-20 21:17:20.000000000 +0300
@@ -49,16 +49,18 @@
 #endif
 #define __KERNEL_SYSCALLS__
 #include <linux/unistd.h>
+
+#include "drivers/kcompat.h"
+
 /* DevFS header */
-#if LINUX_VERSION_CODE >= KERNEL_VERSION(2,4,0)
+#if defined(LIRC_HAVE_DEVFS)
 #include <linux/devfs_fs_kernel.h>
 #endif
 /* SysFS header */
-#if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,0)
+#if defined(LIRC_HAVE_SYSFS)
 #include <linux/device.h>
 #endif
 
-#include "drivers/kcompat.h"
 #include "drivers/lirc.h"
 #include "lirc_dev.h"
 
diff -Nur lirc-0.8.0-orig/drivers/lirc_imon/lirc_imon.c lirc-0.8.0/drivers/lirc_imon/lirc_imon.c
--- lirc-0.8.0-orig/drivers/lirc_imon/lirc_imon.c	2005-12-03 17:18:07.000000000 +0200
+++ lirc-0.8.0/drivers/lirc_imon/lirc_imon.c	2006-09-20 21:48:02.000000000 +0300
@@ -58,10 +58,13 @@
 #include <linux/slab.h>
 #include <asm/uaccess.h>
 #include <linux/usb.h>
+#include "drivers/kcompat.h"
+
+#if defined(LIRC_HAVE_DEVFS)
 #include <linux/devfs_fs_kernel.h>
+#endif
 
 #include "drivers/lirc.h"
-#include "drivers/kcompat.h"
 #include "drivers/lirc_dev/lirc_dev.h"
 
 
diff -Nur lirc-0.8.0-orig/drivers/lirc_sasem/lirc_sasem.c lirc-0.8.0/drivers/lirc_sasem/lirc_sasem.c
--- lirc-0.8.0-orig/drivers/lirc_sasem/lirc_sasem.c	2005-12-03 17:18:07.000000000 +0200
+++ lirc-0.8.0/drivers/lirc_sasem/lirc_sasem.c	2006-09-20 22:54:01.000000000 +0300
@@ -67,10 +67,13 @@
 #include <linux/slab.h>
 #include <asm/uaccess.h>
 #include <linux/usb.h>
+#include "drivers/kcompat.h"
+
+#if defined(LIRC_HAVE_DEVFS)
 #include <linux/devfs_fs_kernel.h>
+#endif
 
 #include "drivers/lirc.h"
-#include "drivers/kcompat.h"
 #include "drivers/lirc_dev/lirc_dev.h"
 
 

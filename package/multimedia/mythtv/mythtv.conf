# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: package/.../mythtv/mythtv.conf
# Copyright (C) 2004 - 2005 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- T2-COPYRIGHT-NOTE-END ---
#prefix=/opt/mythtv
#set_confopt

# brain damaged hardcoded path... have to replace it...
fix_mythtv_prefix() {
	destdir="$root/$prefix" ; destdir="`echo $destdir | tr -s '/'`"
	grep /usr/local * -R | sed 's,:.*,,' | xargs -n1 sed -i "s,/usr/local,$destdir,g"
}
hook_add preconf 3 "fix_mythtv_prefix"

hook_add premake 5 "qmake mythtv.pro"
hook_add postinstall 5 "cp -v setup/setup $bindir/mythtv-setup"

# Config is not automatic...
#FIXME these things should be configurable via a config.in
#      ... to be done ... see TODO's

##################################################
using_x11() {
	cat <<EOF >> settings.pro
# X11 support
CONFIG += using_x11
EOF
}

#DEFAULT
hook_add preconf 5 using_x11

##################################################
using_xv() {
	cat <<EOF >> settings.pro
# Default Xv support
CONFIG += using_xv
EXTRA_LIBS += -L/usr/X11R6/lib -lXinerama -lXv -lX11 -lXext -lXxf86vm
EOF
}

#DEFAULT
hook_add preconf 5 using_xv

##################################################
using_ivtv() {
	cat <<EOF >> settings.pro
# IVTV (PVR-x50) support.  Disable if building on Windows.
CONFIG += using_ivtv
DEFINES += USING_IVTV
EOF
}

#DEFAULT
using_ivtv

##################################################
using_lcdproc() {
	cat <<EOF >> settings.pro
# LCDProc support
DEFINES += LCD_DEVICE
EOF
}

#TODO

##################################################
using_oss() {
	cat <<EOF >> settings.pro
# Default audio output, OSS
CONFIG += using_oss
DEFINES += USING_OSS
EOF
}

#DEFAULT
using_oss

##################################################
using_alsa() {
	cat <<EOF >> settings.pro
# Native ALSA support
CONFIG += using_alsa
ALSA_LIBS = -lasound
EOF
}

pkginstalled alsa-lib && hook_add preconf 5 using_oss

##################################################
using_arts() {
	cat <<EOF >> settings.pro
# Native ARTS support
CONFIG += using_arts
ARTS_LIBS = `artsc-config --libs`
EXTRA_LIBS += `artsc-config --libs`
INCLUDEPATH += `artsc-config --arts-prefix`/include
EOF
}

pkginstalled arts && hook_add preconf 5 using_arts

##################################################
using_dvb() {
	cat <<EOF >> settings.pro
# DVB support
CONFIG += using_dvb
DEFINES += USING_DVB
# Note: INCLUDEPATH should point to the directory with
#   'linux/dvb/frontend.h', not the directory with frontend.h
INCLUDEPATH += TODO
EOF
}

#TODO

##################################################
using_lirc() {
	cat <<EOF >> settings.pro
# Native lirc support
CONFIG += using_lirc
LIRC_LIBS = -llirc_client
EOF
}

#TODO

##################################################
using_xvmc() {
	cat <<EOF >> settings.pro
# XvMC support, modify as necessary.
CONFIG += using_xvmc
DEFINES += USING_XVMC
EXTRA_LIBS += -lXvMCNVIDIA -lXvMC
EOF
}

#TODO

##################################################
using_via_cle266() {
	cat <<EOF >> settings.pro
# VIA cle266 support
CONFIG += using_viahwslice
DEFINES += USING_VIASLICE
EXTRA_LIBS += -lddmpeg
EOF
}

#TODO

##################################################
using_directfb() {
	cat <<EOF >> settings.pro
# DirectFB support
CONFIG += using_directfb
EXTRA_LIBS += `directfb-config --libs`
QMAKE_CXXFLAGS += `directfb-config --cflags`
EOF
}

pkginstalled directfb && hook_add preconf 5 using_directfb

##################################################
using_macx() {
	cat <<EOF >> settings.pro
# Mac OS X support
macx {
    # For source that uses Qt, Q_OS_MACX is defined.
    # For source that uses config.h, CONFIG_DARWIN is defined.
    # For other source (e.g. libmythtv), we define this
    DEFINES += CONFIG_DARWIN
}
EOF
}

##################################################
using_opengl() {
	cat <<EOF >> settings.pro
# OpenGL support for vertical retrace sync
DEFINES += USING_OPENGL_VSYNC
EXTRA_LIBS += -lGL -lGLU
CONFIG += using_opengl
EOF
}

#TODO

##################################################
using_xrandr() {
	cat <<EOF >> settings.pro
# Allow use of XrandR to change display resolutions
CONFIG += using_xrandr
DEFINES += USING_XRANDR
EOF
}

#TODO

# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: package/*/mythtv/mythtv.conf
# Copyright (C) 2004 - 2021 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

. $base/package/*/*/mythtv-conf.in

runconf=0
hook_add preconf 3 "fix_mythtv_prefix"

# Skip mythuitest, does complain about missing QGLWidget
hook_add preconf 4 "sed -i -e 's,mythuitest,,' ./programs/programs.pro"

hook_add preconf 5 "mythtv_config"

var_append GCC_WRAPPER_APPEND ' ' "-I$root/$prefix/include -L$root/$prefix/lib"

# X11
pkginstalled xorg-server || var_append confopt ' ' "--disable-xv --disable-x11"
pkginstalled libxvmc && var_append confopt ' ' "--enable-xvmc"

# DVB Support
var_append confopt ' ' "--enable-dvb --enable-dvb-eit --dvb-path=$root/usr/include"

# Lirc Support
pkginstalled lirc && var_append confopt ' ' "--enable-lirc"

# controlled by T2 itself
var_append confopt ' ' "--disable-ccache --disable-distcc"

hook_add premake 5 "qmake myth*.pro"
hook_add premake 8 "make qmake"
hook_add postmake 5 "cp -av database contrib $root$datadir"

# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: package/*/hyprland/hyprland.conf
# Copyright (C) 2023 - 2024 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

runmeson=0
runcmake=1
makeinstopt=

pkginstalled systemd || var_append cmakeopt ' ' '-DNO_SYSTEMD=1'

var_append GCC_WRAPPER_INSERT ' ' "-L$root`pkgprefix libdir pixman`"

hook_add postmake 5 "hyprland_pm"
hyprland_pm() {
	mkdir -pv $root$includedir/$pkg/protocols
	mkdir -pv $root$includedir/$pkg/wlroots

	install Hyprland $root$bindir
	install hyprland.pc $root$libdir/pkgconfig/
	install hyprctl/hyprctl $root$bindir
	install hyprpm/hyprpm $root$bindir

	cd .. # need to install stuff outside of objs/
	cp -v protocols/*-protocol.h $root$includedir/$pkg/protocols

	cp -v src/*.h* $root$includedir/$pkg/
	cp -v subprojects/wlroots/build/include/*.h $root$includedir/$pkg/wlroots/

	cp -v $(find subprojects/wlroots/build -name 'libwlroots.so.*' -type f) $root$libdir
}

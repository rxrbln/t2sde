# --- ROCK-COPYRIGHT-NOTE-BEGIN ---
# 
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# Please add additional copyright information _after_ the line containing
# the ROCK-COPYRIGHT-NOTE-END tag. Otherwise it might get removed by
# the ./scripts/Create-CopyPatch script. Do not edit this copyright text!
# 
# ROCK Linux: rock-src/package/*/subversion/subversion.conf
# Copyright (C) 1998 - 2003 ROCK Linux Project
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version. A copy of the GNU General Public
# License can be found at Documentation/COPYING.
# 
# Many people helped and are helping developing ROCK Linux. Please
# have a look at http://www.rocklinux.org/ and the Documentation/TEAM
# file for details.
# 
# --- ROCK-COPYRIGHT-NOTE-END ---

# use the apache prefix
# . $base/package/*/apache/apache.conf

prefix="/usr"

# all this is to build the apache server-side module
# and to make sure no locally included APR stuff get's installed
# as well as no modification to httpd.conf is done ...
if pkginstalled apache; then
	var_append extraconfopt " " "--with-apxs=/${ROCKCFG_PKG_APACHE_PREFIX}/sbin/apxs \
				     --with-apr=/${ROCKCFG_PKG_APACHE_PREFIX}/bin/apr-config \
				     --with-apr-util=/${ROCKCFG_PKG_APACHE_PREFIX} \
				     --disable-mod-activation"
# --with-berkeley-db=/usr/include/db40:/usr/lib
fi

# build and install perl bindings
svn_inst_pl() {
	make swig-pl
	make install-swig-pl
}

# build and install python bindings
svn_inst_py() {
	PYTHON_SITE=`python -c "import os,sys; print os.path.join(sys.prefix, 'lib','python'+sys.version[:3],'site-packages')"`
	make swig-py
	make install-swig-py \
		swig_pydir=$PYTHON_SITE/svn/libsvn \
		swig_pydir_extra=$PYTHON_SITE/svn
}

hook_add postmake 3 "install_init svnserve $confdir/svnserve.init"
hook_add postmake 4 "cp -vrf tools $docdir"

# if swig is present build and install the perl and python bindings
if pkginstalled swig; then
	pkginstalled perl && hook_add postmake 5 "svn_inst_pl"
	pkginstalled python && hook_add postmake 6 "svn_inst_py"
fi

# use system wide neon
pkginstalled neon && var_append extraconfopt " " "--with-neon=$root/usr"


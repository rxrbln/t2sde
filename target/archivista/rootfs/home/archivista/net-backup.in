#!/bin/bash

mount_net ()
{
	mpoint="$1"

	if [ -e /etc/net-backup.conf ]; then
		. /etc/net-backup.conf
	else
		echo "No config file /etc/net-backup.conf."
		return 1
	fi

	mkdir -p $mpoint

	if [ "$type" = cifs ]; then
		# construct options variable
		append () {
			${options:+,}
			options="$options$1"
		}
		[ "$user" ] && append "user=$user"
		[ "$passwd" ] && append "passwd=$passwd"
		[ "$domain" ] && append "domain=$domain"
		[ "$options" ] && options="-o $options"

		mount -t $type //$server/$share $mpoint $options
	else
		mount -t $type $server:/$share $mpoint
	fi
	error=$?
	if [ $error -ne 0 ]; then
		echo "Error mouting network share: $error."
		return 1
	fi

	if ! grep -q $mpoint /proc/mounts; then
		echo "Network share does not appear to be mounted correctly."
		return 1
	fi
}


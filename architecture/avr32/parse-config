# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: architecture/avr32/parse-config
# Copyright (C) 2004 - 2021 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

# default to a newer C standard
case $pkg in
	linux|e2fsprogs)
		:
		;;
	*)
		var_append CC_WRAPPER_INSERT ' ' '-std=gnu99'
		;;
esac

# other quirks and overrides
case $pkg in
	glib)
		var_append GCC_WRAPPER_REMOVE ' ' '-Werror=missing-prototypes'
		;;
	sysvinit)
		var_append GCC_WRAPPER_REMOVE ' ' '-fstack-protector-strong'
		;;
	procps|sysklogd)
		var_append GCC_WRAPPER_REMOVE ' ' '-Wno-unused-result'
		;;
	nfs-utils)
		var_append GCC_WRAPPER_REMOVE ' ' '-Wno-cast-function-type -Werror=unused-result'
		;;
	iptables)
		var_append GCC_WRAPPER_REMOVE ' ' '-Wlogical-op'
		;;
	libusb)
		var_append GCC_WRAPPER_REMOVE ' ' '-std=gnu11'
		var_append GCC_WRAPPER_APPEND ' ' '-D_Thread_local='''
		# Note: manually, on CLI, this needs extra quotes!
		var_append GCC_WRAPPER_APPEND ' ' "-D_Static_assert(a,b)=do{}while(0)"
		;;
	libgcrypt)
		var_append CC_WRAPPER_APPEND ' ' './rndjent.c?-O0:'
		;;
	udev)
		var_append GCC_WRAPPER_REMOVE ' ' '-Wtype-limits'
		;;
esac
